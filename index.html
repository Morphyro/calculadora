<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Qu√≠mica de Solu√ß√µes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab {
            flex: 1;
            min-width: 120px;
            padding: 15px 10px;
            background: #f5f5f5;
            border: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .content {
            padding: 25px;
        }

        .calc-section {
            display: none;
        }

        .calc-section.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border 0.3s, background 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        input.calculated {
            background: #e8f5e9;
            border-color: #4caf50;
        }

        .input-with-unit {
            display: flex;
            gap: 10px;
        }

        .input-with-unit input {
            flex: 2;
        }

        .input-with-unit select {
            flex: 1;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 10px;
        }

        button:active {
            transform: scale(0.98);
        }

        button:hover {
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button.clear-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%);
            margin-top: 10px;
        }

        .result {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 10px;
            color: white;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            display: none;
            animation: slideIn 0.3s;
        }

        .result.success {
            background: linear-gradient(135deg, #38ef7d 0%, #11998e 100%);
        }

        .result.error {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result.show {
            display: block;
        }

        .formula {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .formula-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 8px;
        }

        .formula-text {
            font-family: 'Courier New', monospace;
            color: #555;
            font-size: 14px;
        }

        .info {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 13px;
            color: #1976d2;
        }

        .info.tip {
            background: #fff3e0;
            color: #e65100;
            border-left: 4px solid #ff9800;
        }

        .calculation-steps {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 13px;
            color: #555;
            line-height: 1.8;
        }

        .calculation-steps .step {
            margin: 5px 0;
            padding-left: 10px;
            border-left: 2px solid #667eea;
        }

        .btn-desenvolvimento {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #38ef7d 0%, #11998e 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            display: none;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn-desenvolvimento:hover {
            box-shadow: 0 5px 15px rgba(17, 153, 142, 0.4);
            transform: translateY(-2px);
        }

        .btn-desenvolvimento.show {
            display: block;
        }

        /* Modal/Popup */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .modal-overlay.show {
            display: flex;
            animation: fadeInOverlay 0.3s ease;
        }

        @keyframes fadeInOverlay {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideInModal 0.3s ease;
        }

        @keyframes slideInModal {
            from { 
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to { 
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 18px;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .modal-body {
            padding: 25px;
        }

        .desenvolvimento-step {
            margin-bottom: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .desenvolvimento-step:last-child {
            border-left-color: #38ef7d;
            background: #e8f5e9;
        }

        .step-number {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            text-align: center;
            line-height: 28px;
            font-size: 14px;
            font-weight: bold;
            margin-right: 10px;
        }

        .step-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .step-formula {
            font-family: 'Courier New', monospace;
            background: white;
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 16px;
            color: #333;
            margin: 8px 0;
            border: 1px solid #e0e0e0;
            text-align: center;
        }

        .step-formula.highlight {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-weight: bold;
        }

        .step-description {
            font-size: 13px;
            color: #666;
            margin-top: 8px;
        }

        /* Bot√£o de Ajuda (?) */
        .formula-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 10px;
        }

        .formula-content {
            flex: 1;
        }

        .btn-ajuda {
            width: 32px;
            height: 32px;
            min-width: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .btn-ajuda:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
        }

        /* Modal de Ajuda */
        .modal-ajuda-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1001;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .modal-ajuda-overlay.show {
            display: flex;
            animation: fadeInOverlay 0.3s ease;
        }

        .modal-ajuda-content {
            background: white;
            border-radius: 20px;
            max-width: 550px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideInModal 0.3s ease;
        }

        .modal-ajuda-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-ajuda-header h2 {
            margin: 0;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-ajuda-body {
            padding: 25px;
        }

        .ajuda-secao {
            margin-bottom: 20px;
        }

        .ajuda-secao:last-child {
            margin-bottom: 0;
        }

        .ajuda-titulo {
            font-weight: 700;
            color: #667eea;
            font-size: 15px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ajuda-texto {
            color: #555;
            font-size: 14px;
            line-height: 1.7;
        }

        .ajuda-formula-destaque {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            text-align: center;
            margin: 15px 0;
            font-weight: bold;
        }

        .ajuda-exemplo {
            background: #f0f7ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            border-radius: 0 10px 10px 0;
            margin: 15px 0;
        }

        .ajuda-exemplo-titulo {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .ajuda-exemplo-texto {
            color: #555;
            font-size: 13px;
            line-height: 1.6;
        }

        .ajuda-dica {
            background: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 12px 15px;
            border-radius: 0 10px 10px 0;
            margin: 15px 0;
            font-size: 13px;
            color: #795548;
        }

        .ajuda-variaveis {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 8px 15px;
            margin: 10px 0;
            font-size: 14px;
        }

        .ajuda-var {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #667eea;
        }

        .ajuda-var-desc {
            color: #555;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß™ Calculadora Qu√≠mica </h1>
                <p>C√°lculos de Solu√ß√µes e Concentra√ß√µes<br>Turma: S1N - 2025</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('conc-comum')">C (g/L)</button>
            <button class="tab" onclick="showTab('molar')">Conc. Molar</button>
            <button class="tab" onclick="showTab('porcentagem')">%</button>
            <button class="tab" onclick="showTab('densidade')">Densidade</button>
            <button class="tab" onclick="showTab('fracao')">Fra√ß√£o</button>
            <button class="tab" onclick="showTab('solubilidade')">Solubilidade</button>
            <button class="tab" onclick="showTab('diluicao')">Dilui√ß√£o</button>
            <button class="tab" onclick="showTab('massa-molar')">Massa Molar</button>
        </div>

        <div class="content">
            <!-- Concentra√ß√£o Comum -->
            <div class="calc-section active" id="conc-comum">
                <div class="formula">
                    <div class="formula-container">
                        <div class="formula-content">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">C = m‚ÇÅ / V (g/L)</div>
                        </div>
                        <button class="btn-ajuda" onclick="showAjuda('conc-comum')" title="O que √© isso?">?</button>
                    </div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Concentra√ß√£o (C)</label>
                    <div class="input-with-unit">
                        <input type="number" id="cc-conc" step="any" placeholder="Deixe vazio para calcular">
                        <select id="cc-conc-unit">
                            <option value="1">g/L</option>
                            <option value="0.001">mg/L</option>
                            <option value="1000">kg/L</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa do soluto (m‚ÇÅ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="cc-massa" step="any" placeholder="Deixe vazio para calcular">
                        <select id="cc-massa-unit">
                            <option value="1">g</option>
                            <option value="0.001">mg</option>
                            <option value="1000">kg</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume da solu√ß√£o (V)</label>
                    <div class="input-with-unit">
                        <input type="number" id="cc-volume" step="any" placeholder="Deixe vazio para calcular">
                        <select id="cc-volume-unit">
                            <option value="1">L</option>
                            <option value="0.001">mL</option>
                            <option value="0.000001">ŒºL</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcConcComum()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('cc')">Limpar</button>
                <div class="result" id="cc-result"></div>
                <button class="btn-desenvolvimento" id="cc-btn-dev" onclick="showDesenvolvimento('cc')">üìê Ver Desenvolvimento</button>
            </div>

            <!-- Concentra√ß√£o Molar -->
            <div class="calc-section" id="molar">
                <div class="formula">
                    <div class="formula-container">
                        <div class="formula-content">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">M = n / V = m / (MM √ó V) (mol/L)</div>
                        </div>
                        <button class="btn-ajuda" onclick="showAjuda('molar')" title="O que √© isso?">?</button>
                    </div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Molaridade (M)</label>
                    <div class="input-with-unit">
                        <input type="number" id="m-molar" step="any" placeholder="Deixe vazio para calcular">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px;">mol/L</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa do soluto (m)</label>
                    <div class="input-with-unit">
                        <input type="number" id="m-massa" step="any" placeholder="Deixe vazio para calcular">
                        <select id="m-massa-unit">
                            <option value="1">g</option>
                            <option value="0.001">mg</option>
                            <option value="1000">kg</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa Molar (MM) - Obrigat√≥rio</label>
                    <div class="input-with-unit">
                        <input type="number" id="m-mm" step="any" placeholder="g/mol">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px;">g/mol</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume da solu√ß√£o (V)</label>
                    <div class="input-with-unit">
                        <input type="number" id="m-volume" step="any" placeholder="Deixe vazio para calcular">
                        <select id="m-volume-unit">
                            <option value="1">L</option>
                            <option value="0.001">mL</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcMolar()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('m')">Limpar</button>
                <div class="result" id="m-result"></div>
                <button class="btn-desenvolvimento" id="m-btn-dev" onclick="showDesenvolvimento('m')">üìê Ver Desenvolvimento</button>
            </div>

            <!-- Porcentagem -->
            <div class="calc-section" id="porcentagem">
                <div class="formula">
                    <div class="formula-container">
                        <div class="formula-content">
                            <div class="formula-title">F√≥rmula</div>
                            <div class="formula-text">% = (parte / total) √ó 100</div>
                        </div>
                        <button class="btn-ajuda" onclick="showAjuda('porcentagem')" title="O que √© isso?">?</button>
                    </div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Tipo de Concentra√ß√£o</label>
                    <select id="p-tipo" onchange="updatePorcentagemLabels()">
                        <option value="mm">Massa/Massa (m/m %)</option>
                        <option value="vv">Volume/Volume (v/v %)</option>
                        <option value="mv">Massa/Volume (m/v %)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Porcentagem (%)</label>
                    <div class="input-with-unit">
                        <input type="number" id="p-perc" step="any" placeholder="Deixe vazio para calcular">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px;">%</span>
                    </div>
                </div>
                <div id="p-inputs">
                    <div class="input-group">
                        <label id="p-label1">Massa do soluto</label>
                        <div class="input-with-unit">
                            <input type="number" id="p-val1" step="any" placeholder="Deixe vazio para calcular">
                            <select id="p-unit1">
                                <option value="1">g</option>
                                <option value="0.001">mg</option>
                                <option value="1000">kg</option>
                            </select>
                        </div>
                    </div>
                    <div class="input-group">
                        <label id="p-label2">Massa da solu√ß√£o</label>
                        <div class="input-with-unit">
                            <input type="number" id="p-val2" step="any" placeholder="Deixe vazio para calcular">
                            <select id="p-unit2">
                                <option value="1">g</option>
                                <option value="0.001">mg</option>
                                <option value="1000">kg</option>
                            </select>
                        </div>
                    </div>
                </div>
                <button onclick="calcPorcentagem()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('p')">Limpar</button>
                <div class="result" id="p-result"></div>
                <button class="btn-desenvolvimento" id="p-btn-dev" onclick="showDesenvolvimento('p')">üìê Ver Desenvolvimento</button>
            </div>

            <!-- Densidade -->
            <div class="calc-section" id="densidade">
                <div class="formula">
                    <div class="formula-container">
                        <div class="formula-content">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">d = m / V</div>
                        </div>
                        <button class="btn-ajuda" onclick="showAjuda('densidade')" title="O que √© isso?">?</button>
                    </div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Densidade (d)</label>
                    <div class="input-with-unit">
                        <input type="number" id="d-dens" step="any" placeholder="Deixe vazio para calcular">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px;">g/mL</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa (m)</label>
                    <div class="input-with-unit">
                        <input type="number" id="d-massa" step="any" placeholder="Deixe vazio para calcular">
                        <select id="d-massa-unit">
                            <option value="1">g</option>
                            <option value="0.001">mg</option>
                            <option value="1000">kg</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume (V)</label>
                    <div class="input-with-unit">
                        <input type="number" id="d-volume" step="any" placeholder="Deixe vazio para calcular">
                        <select id="d-volume-unit">
                            <option value="1">mL</option>
                            <option value="1000">L</option>
                            <option value="0.001">ŒºL</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcDensidade()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('d')">Limpar</button>
                <div class="result" id="d-result"></div>
                <button class="btn-desenvolvimento" id="d-btn-dev" onclick="showDesenvolvimento('d')">üìê Ver Desenvolvimento</button>
            </div>

            <!-- Fra√ß√£o Molar -->
            <div class="calc-section" id="fracao">
                <div class="formula">
                    <div class="formula-container">
                        <div class="formula-content">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">X‚ÇÅ = n‚ÇÅ / (n‚ÇÅ + n‚ÇÇ)</div>
                        </div>
                        <button class="btn-ajuda" onclick="showAjuda('fracao')" title="O que √© isso?">?</button>
                    </div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Fra√ß√£o Molar do soluto (X‚ÇÅ)</label>
                    <input type="number" id="f-x" step="any" placeholder="Deixe vazio para calcular (0 a 1)">
                </div>
                <div class="input-group">
                    <label>N√∫mero de mols do soluto (n‚ÇÅ)</label>
                    <input type="number" id="f-n1" step="any" placeholder="Deixe vazio para calcular">
                </div>
                <div class="input-group">
                    <label>N√∫mero de mols do solvente (n‚ÇÇ)</label>
                    <input type="number" id="f-n2" step="any" placeholder="Deixe vazio para calcular">
                </div>
                <button onclick="calcFracaoMolar()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('f')">Limpar</button>
                <div class="result" id="f-result"></div>
                <button class="btn-desenvolvimento" id="f-btn-dev" onclick="showDesenvolvimento('f')">üìê Ver Desenvolvimento</button>
            </div>

            <!-- Coeficiente de Solubilidade -->
            <div class="calc-section" id="solubilidade">
                <div class="formula">
                    <div class="formula-container">
                        <div class="formula-content">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">Cs = (massa soluto / massa solvente) √ó 100</div>
                        </div>
                        <button class="btn-ajuda" onclick="showAjuda('solubilidade')" title="O que √© isso?">?</button>
                    </div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Coeficiente de Solubilidade (Cs)</label>
                    <div class="input-with-unit">
                        <input type="number" id="s-cs" step="any" placeholder="Deixe vazio para calcular">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px; font-size: 12px;">g/100g</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa de soluto dissolvida</label>
                    <div class="input-with-unit">
                        <input type="number" id="s-soluto" step="any" placeholder="Deixe vazio para calcular">
                        <select id="s-soluto-unit">
                            <option value="1">g</option>
                            <option value="0.001">mg</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa do solvente</label>
                    <div class="input-with-unit">
                        <input type="number" id="s-solvente" step="any" placeholder="Deixe vazio para calcular">
                        <select id="s-solvente-unit">
                            <option value="1">g</option>
                            <option value="1000">kg</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcSolubilidade()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('s')">Limpar</button>
                <div class="result" id="s-result"></div>
                <button class="btn-desenvolvimento" id="s-btn-dev" onclick="showDesenvolvimento('s')">üìê Ver Desenvolvimento</button>
            </div>

            <!-- Dilui√ß√£o -->
            <div class="calc-section" id="diluicao">
                <div class="formula">
                    <div class="formula-container">
                        <div class="formula-content">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">C‚ÇÅ √ó V‚ÇÅ = C‚ÇÇ √ó V‚ÇÇ</div>
                        </div>
                        <button class="btn-ajuda" onclick="showAjuda('diluicao')" title="O que √© isso?">?</button>
                    </div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Concentra√ß√£o inicial (C‚ÇÅ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="dil-c1" step="any" placeholder="Deixe vazio para calcular">
                        <select id="dil-c1-unit">
                            <option value="1">mol/L</option>
                            <option value="1">g/L</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume inicial (V‚ÇÅ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="dil-v1" step="any" placeholder="Deixe vazio para calcular">
                        <select id="dil-v1-unit">
                            <option value="1">L</option>
                            <option value="0.001">mL</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Concentra√ß√£o final (C‚ÇÇ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="dil-c2" step="any" placeholder="Deixe vazio para calcular">
                        <select id="dil-c2-unit">
                            <option value="1">mol/L</option>
                            <option value="1">g/L</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume final (V‚ÇÇ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="dil-v2" step="any" placeholder="Deixe vazio para calcular">
                        <select id="dil-v2-unit">
                            <option value="1">L</option>
                            <option value="0.001">mL</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcDiluicao()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('dil')">Limpar</button>
                <div class="result" id="dil-result"></div>
                <button class="btn-desenvolvimento" id="dil-btn-dev" onclick="showDesenvolvimento('dil')">üìê Ver Desenvolvimento</button>
            </div>

            <!-- Massa Molar -->
            <div class="calc-section" id="massa-molar">
                <div class="formula">
                    <div class="formula-container">
                        <div class="formula-content">
                            <div class="formula-title">Calculadora de Massa Molar</div>
                            <div class="formula-text">MM = Œ£ (massa at√¥mica √ó quantidade)</div>
        </div>
                        <button class="btn-ajuda" onclick="showAjuda('massa-molar')" title="O que √© isso?">?</button>
                    </div>
                </div>
                <div class="info">
                    ‚öóÔ∏è Digite a f√≥rmula qu√≠mica do composto (ex: H2O, NaCl, H2SO4, Ca(OH)2)
                </div>
                <div class="input-group">
                    <label>F√≥rmula Qu√≠mica</label>
                    <input type="text" id="mm-formula" placeholder="Ex: H2O, NaCl, H2SO4, Ca(OH)2" style="text-transform: none;" oninput="this.value = this.value.replace(/[^A-Za-z0-9()]/g, '')">
                </div>
                <button onclick="calcMassaMolar()">Calcular Massa Molar</button>
                <button class="clear-btn" onclick="clearMassaMolar()">Limpar</button>
                <div class="result" id="mm-result"></div>
                <button class="btn-desenvolvimento" id="mm-btn-dev" onclick="showDesenvolvimento('mm')">üìê Ver Desenvolvimento</button>
                
                <div style="margin-top: 20px; padding: 15px; background: #f9f9f9; border-radius: 10px;">
                    <div style="font-weight: 600; color: #667eea; margin-bottom: 10px;">üìã Elementos Dispon√≠veis:</div>
                    <div id="elementos-lista" style="font-size: 12px; color: #555; line-height: 1.8; max-height: 200px; overflow-y: auto;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Ajuda -->
    <div class="modal-ajuda-overlay" id="modal-ajuda" onclick="closeModalAjudaOutside(event)">
        <div class="modal-ajuda-content" onclick="event.stopPropagation()">
            <div class="modal-ajuda-header">
                <h2>‚ùì <span id="modal-ajuda-titulo">Ajuda</span></h2>
                <button class="modal-close" onclick="closeModalAjuda()">&times;</button>
            </div>
            <div class="modal-ajuda-body" id="modal-ajuda-body">
                <!-- Conte√∫do da ajuda ser√° inserido aqui -->
            </div>
        </div>
    </div>

    <!-- Modal de Desenvolvimento -->
    <div class="modal-overlay" id="modal-desenvolvimento" onclick="closeModalOutside(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>üìê Desenvolvimento do C√°lculo</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modal-body-content">
                <!-- Conte√∫do do desenvolvimento ser√° inserido aqui -->
            </div>
        </div>
    </div>

    <script>
        function showTab(tabId) {
            const tabs = document.querySelectorAll('.tab');
            const sections = document.querySelectorAll('.calc-section');
            
            tabs.forEach(t => t.classList.remove('active'));
            sections.forEach(s => s.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // Armazena os dados de desenvolvimento de cada c√°lculo
        let desenvolvimentoData = {};

        // Conte√∫dos de Ajuda Did√°tica
        const ajudaConteudos = {
            'conc-comum': {
                titulo: 'Concentra√ß√£o Comum (g/L)',
                conteudo: `
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üìö O que √©?</div>
                        <div class="ajuda-texto">
                            A <strong>concentra√ß√£o comum</strong> (tamb√©m chamada de concentra√ß√£o em massa) indica 
                            <strong>quantos gramas de soluto</strong> est√£o dissolvidos em <strong>cada litro de solu√ß√£o</strong>.
                            √â como perguntar: "Quanto de subst√¢ncia tem em cada litro?"
                        </div>
                    </div>
                    
                    <div class="ajuda-formula-destaque">C = m‚ÇÅ / V</div>
                    
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üî§ O que cada letra significa?</div>
                        <div class="ajuda-variaveis">
                            <span class="ajuda-var">C</span>
                            <span class="ajuda-var-desc">Concentra√ß√£o (em g/L) - o que queremos descobrir ou j√° sabemos</span>
                            <span class="ajuda-var">m‚ÇÅ</span>
                            <span class="ajuda-var-desc">Massa do soluto (em gramas) - a subst√¢ncia que foi dissolvida</span>
                            <span class="ajuda-var">V</span>
                            <span class="ajuda-var-desc">Volume da solu√ß√£o (em litros) - o volume total ap√≥s misturar</span>
                        </div>
                    </div>
                    
                    <div class="ajuda-exemplo">
                        <div class="ajuda-exemplo-titulo">üß™ Exemplo do dia a dia:</div>
                        <div class="ajuda-exemplo-texto">
                            Imagine que voc√™ dissolve <strong>20g de a√ß√∫car</strong> em √°gua at√© completar <strong>500mL de solu√ß√£o</strong>.<br><br>
                            Convertendo: 500 mL = 0,5 L<br>
                            C = 20g / 0,5L = <strong>40 g/L</strong><br><br>
                            Isso significa que cada litro dessa solu√ß√£o cont√©m 40g de a√ß√∫car!
                        </div>
                    </div>
                    
                    <div class="ajuda-dica">
                        üí° <strong>Dica:</strong> Soluto √© o que dissolve (a√ß√∫car, sal), solvente √© onde dissolve (geralmente √°gua), 
                        e solu√ß√£o √© a mistura dos dois!
                    </div>
                `
            },
            'molar': {
                titulo: 'Concentra√ß√£o Molar (mol/L)',
                conteudo: `
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üìö O que √©?</div>
                        <div class="ajuda-texto">
                            A <strong>concentra√ß√£o molar</strong> (ou molaridade) indica <strong>quantos mols de soluto</strong> 
                            est√£o presentes em <strong>cada litro de solu√ß√£o</strong>. √â a unidade mais usada em laborat√≥rios 
                            porque facilita os c√°lculos de rea√ß√µes qu√≠micas.
                        </div>
                    </div>
                    
                    <div class="ajuda-formula-destaque">M = n / V = m / (MM √ó V)</div>
                    
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üî§ O que cada letra significa?</div>
                        <div class="ajuda-variaveis">
                            <span class="ajuda-var">M</span>
                            <span class="ajuda-var-desc">Molaridade (em mol/L) - concentra√ß√£o em quantidade de mat√©ria</span>
                            <span class="ajuda-var">n</span>
                            <span class="ajuda-var-desc">N√∫mero de mols do soluto</span>
                            <span class="ajuda-var">m</span>
                            <span class="ajuda-var-desc">Massa do soluto (em gramas)</span>
                            <span class="ajuda-var">MM</span>
                            <span class="ajuda-var-desc">Massa molar do soluto (em g/mol) - soma das massas at√¥micas</span>
                            <span class="ajuda-var">V</span>
                            <span class="ajuda-var-desc">Volume da solu√ß√£o (em litros)</span>
                        </div>
                    </div>
                    
                    <div class="ajuda-exemplo">
                        <div class="ajuda-exemplo-titulo">üß™ Exemplo pr√°tico:</div>
                        <div class="ajuda-exemplo-texto">
                            Dissolvemos <strong>40g de NaOH</strong> (MM = 40 g/mol) em √°gua at√© <strong>2 litros</strong>.<br><br>
                            M = 40g / (40 g/mol √ó 2L) = 40 / 80 = <strong>0,5 mol/L</strong><br><br>
                            Ou seja: cada litro cont√©m 0,5 mol de NaOH (meio mol por litro).
                        </div>
                    </div>
                    
                    <div class="ajuda-dica">
                        üí° <strong>O que √© mol?</strong> √â uma quantidade fixa de part√≠culas (6,02 √ó 10¬≤¬≥). 
                        Assim como "d√∫zia" significa 12, "mol" significa 602 sextilh√µes de part√≠culas!
                    </div>
                `
            },
            'porcentagem': {
                titulo: 'Concentra√ß√£o em Porcentagem (%)',
                conteudo: `
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üìö O que √©?</div>
                        <div class="ajuda-texto">
                            A <strong>concentra√ß√£o percentual</strong> indica quanto de soluto existe em rela√ß√£o ao 
                            total, expressa em <strong>porcentagem</strong>. Existem tr√™s tipos:
                        </div>
                    </div>
                    
                    <div class="ajuda-formula-destaque">% = (parte / total) √ó 100</div>
                    
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üìä Os tr√™s tipos:</div>
                        <div class="ajuda-variaveis">
                            <span class="ajuda-var">m/m %</span>
                            <span class="ajuda-var-desc">Massa/Massa - gramas de soluto em 100g de solu√ß√£o</span>
                            <span class="ajuda-var">v/v %</span>
                            <span class="ajuda-var-desc">Volume/Volume - mL de soluto em 100mL de solu√ß√£o</span>
                            <span class="ajuda-var">m/v %</span>
                            <span class="ajuda-var-desc">Massa/Volume - gramas de soluto em 100mL de solu√ß√£o</span>
                        </div>
                    </div>
                    
                    <div class="ajuda-exemplo">
                        <div class="ajuda-exemplo-titulo">üß™ Exemplo do dia a dia:</div>
                        <div class="ajuda-exemplo-texto">
                            <strong>Soro fisiol√≥gico 0,9%</strong> significa que em cada 100mL de soro, 
                            existem 0,9g de NaCl (sal).<br><br>
                            <strong>√Ålcool 70%</strong> significa que em cada 100mL, 70mL s√£o √°lcool 
                            e 30mL s√£o √°gua (v/v).<br><br>
                            <strong>Leite integral ‚âà3,5%</strong> de gordura significa 3,5g de gordura 
                            para cada 100g de leite (m/m).
                        </div>
                    </div>
                    
                    <div class="ajuda-dica">
                        üí° <strong>Dica:</strong> Olhe os r√≥tulos! Produtos como cremes, medicamentos e alimentos 
                        sempre indicam concentra√ß√µes em porcentagem.
                    </div>
                `
            },
            'densidade': {
                titulo: 'Densidade (g/mL)',
                conteudo: `
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üìö O que √©?</div>
                        <div class="ajuda-texto">
                            A <strong>densidade</strong> indica <strong>quanta massa</strong> existe em um 
                            <strong>determinado volume</strong>. √â como perguntar: "Esse material √© pesado ou leve 
                            para o seu tamanho?"
                        </div>
                    </div>
                    
                    <div class="ajuda-formula-destaque">d = m / V</div>
                    
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üî§ O que cada letra significa?</div>
                        <div class="ajuda-variaveis">
                            <span class="ajuda-var">d</span>
                            <span class="ajuda-var-desc">Densidade (em g/mL ou g/cm¬≥)</span>
                            <span class="ajuda-var">m</span>
                            <span class="ajuda-var-desc">Massa (em gramas)</span>
                            <span class="ajuda-var">V</span>
                            <span class="ajuda-var-desc">Volume (em mL ou cm¬≥)</span>
                        </div>
                    </div>
                    
                    <div class="ajuda-exemplo">
                        <div class="ajuda-exemplo-titulo">üß™ Exemplos comparativos:</div>
                        <div class="ajuda-exemplo-texto">
                            <strong>√Ågua:</strong> d = 1 g/mL (1 litro pesa 1 kg)<br>
                            <strong>√ìleo:</strong> d ‚âà 0,9 g/mL (mais leve que √°gua, por isso flutua!)<br>
                            <strong>Merc√∫rio:</strong> d = 13,6 g/mL (muito denso, metais afundam nele)<br>
                            <strong>Ferro:</strong> d = 7,87 g/cm¬≥<br><br>
                            Por que o gelo flutua? Porque a densidade do gelo (0,92 g/mL) √© menor que da √°gua l√≠quida!
                        </div>
                    </div>
                    
                    <div class="ajuda-dica">
                        üí° <strong>Macete:</strong> Se a densidade √© maior que 1 g/mL, o objeto afunda na √°gua. 
                        Se for menor que 1, ele flutua!
                    </div>
                `
            },
            'fracao': {
                titulo: 'Fra√ß√£o Molar',
                conteudo: `
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üìö O que √©?</div>
                        <div class="ajuda-texto">
                            A <strong>fra√ß√£o molar</strong> indica a <strong>propor√ß√£o</strong> de mols de um 
                            componente em rela√ß√£o ao <strong>total de mols</strong> da solu√ß√£o. √â um n√∫mero 
                            entre 0 e 1 (ou 0% a 100%).
                        </div>
                    </div>
                    
                    <div class="ajuda-formula-destaque">X‚ÇÅ = n‚ÇÅ / (n‚ÇÅ + n‚ÇÇ)</div>
                    
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üî§ O que cada letra significa?</div>
                        <div class="ajuda-variaveis">
                            <span class="ajuda-var">X‚ÇÅ</span>
                            <span class="ajuda-var-desc">Fra√ß√£o molar do soluto (valor entre 0 e 1)</span>
                            <span class="ajuda-var">n‚ÇÅ</span>
                            <span class="ajuda-var-desc">N√∫mero de mols do soluto</span>
                            <span class="ajuda-var">n‚ÇÇ</span>
                            <span class="ajuda-var-desc">N√∫mero de mols do solvente</span>
                            <span class="ajuda-var">X‚ÇÇ</span>
                            <span class="ajuda-var-desc">Fra√ß√£o molar do solvente (X‚ÇÇ = 1 - X‚ÇÅ)</span>
                        </div>
                    </div>
                    
                    <div class="ajuda-exemplo">
                        <div class="ajuda-exemplo-titulo">üß™ Exemplo:</div>
                        <div class="ajuda-exemplo-texto">
                            Misturamos <strong>1 mol de a√ß√∫car</strong> com <strong>4 mols de √°gua</strong>.<br><br>
                            X(a√ß√∫car) = 1 / (1 + 4) = 1/5 = <strong>0,2</strong> (ou 20%)<br>
                            X(√°gua) = 4 / (1 + 4) = 4/5 = <strong>0,8</strong> (ou 80%)<br><br>
                            Note que: 0,2 + 0,8 = 1 (as fra√ß√µes sempre somam 1!)
                        </div>
                    </div>
                    
                    <div class="ajuda-dica">
                        üí° <strong>Importante:</strong> A soma de todas as fra√ß√µes molares sempre √© igual a 1. 
                        Se X‚ÇÅ = 0,3, ent√£o X‚ÇÇ = 0,7 automaticamente!
                    </div>
                `
            },
            'solubilidade': {
                titulo: 'Coeficiente de Solubilidade',
                conteudo: `
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üìö O que √©?</div>
                        <div class="ajuda-texto">
                            O <strong>coeficiente de solubilidade</strong> indica a <strong>quantidade m√°xima</strong> 
                            de soluto que consegue se dissolver em uma quantidade fixa de solvente, a uma determinada 
                            temperatura. √â expresso em <strong>gramas de soluto por 100g de solvente</strong>.
                        </div>
                    </div>
                    
                    <div class="ajuda-formula-destaque">Cs = (m soluto / m solvente) √ó 100</div>
                    
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üî§ O que cada termo significa?</div>
                        <div class="ajuda-variaveis">
                            <span class="ajuda-var">Cs</span>
                            <span class="ajuda-var-desc">Coeficiente de solubilidade (g/100g de solvente)</span>
                            <span class="ajuda-var">m soluto</span>
                            <span class="ajuda-var-desc">Massa da subst√¢ncia dissolvida</span>
                            <span class="ajuda-var">m solvente</span>
                            <span class="ajuda-var-desc">Massa do l√≠quido onde dissolvemos (geralmente √°gua)</span>
                        </div>
                    </div>
                    
                    <div class="ajuda-exemplo">
                        <div class="ajuda-exemplo-titulo">üß™ Exemplo pr√°tico:</div>
                        <div class="ajuda-exemplo-texto">
                            A 20¬∞C, o sal (NaCl) tem Cs = 36 g/100g de √°gua.<br><br>
                            Isso significa que em 100g de √°gua a 20¬∞C, conseguimos dissolver <strong>no m√°ximo</strong> 
                            36g de sal. Se colocarmos mais, o excesso fica no fundo (solu√ß√£o saturada com corpo de fundo).<br><br>
                            <strong>Tipos de solu√ß√£o:</strong><br>
                            ‚Ä¢ Insaturada: tem menos soluto que o m√°ximo<br>
                            ‚Ä¢ Saturada: tem exatamente o m√°ximo<br>
                            ‚Ä¢ Supersaturada: tem mais que o m√°ximo (inst√°vel!)
                        </div>
                    </div>
                    
                    <div class="ajuda-dica">
                        üí° <strong>Curiosidade:</strong> A maioria das subst√¢ncias dissolve mais em √°gua quente. 
                        Por isso o a√ß√∫car dissolve mais r√°pido no caf√© quente!
                    </div>
                `
            },
            'diluicao': {
                titulo: 'Dilui√ß√£o de Solu√ß√µes',
                conteudo: `
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üìö O que √©?</div>
                        <div class="ajuda-texto">
                            <strong>Diluir</strong> √© adicionar mais solvente (geralmente √°gua) a uma solu√ß√£o, 
                            fazendo a concentra√ß√£o <strong>diminuir</strong>. A quantidade de soluto permanece 
                            a mesma, mas agora est√° espalhada em um volume maior!
                        </div>
                    </div>
                    
                    <div class="ajuda-formula-destaque">C‚ÇÅ √ó V‚ÇÅ = C‚ÇÇ √ó V‚ÇÇ</div>
                    
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üî§ O que cada termo significa?</div>
                        <div class="ajuda-variaveis">
                            <span class="ajuda-var">C‚ÇÅ</span>
                            <span class="ajuda-var-desc">Concentra√ß√£o inicial (antes de diluir) - mais concentrada</span>
                            <span class="ajuda-var">V‚ÇÅ</span>
                            <span class="ajuda-var-desc">Volume inicial (antes de diluir) - menor volume</span>
                            <span class="ajuda-var">C‚ÇÇ</span>
                            <span class="ajuda-var-desc">Concentra√ß√£o final (ap√≥s diluir) - mais dilu√≠da</span>
                            <span class="ajuda-var">V‚ÇÇ</span>
                            <span class="ajuda-var-desc">Volume final (ap√≥s diluir) - maior volume</span>
                        </div>
                    </div>
                    
                    <div class="ajuda-exemplo">
                        <div class="ajuda-exemplo-titulo">üß™ Exemplo do dia a dia:</div>
                        <div class="ajuda-exemplo-texto">
                            Voc√™ tem <strong>100mL de suco concentrado</strong> (C‚ÇÅ = 50 g/L) e quer diluir 
                            at√© <strong>500mL</strong>. Qual ser√° a concentra√ß√£o final?<br><br>
                            C‚ÇÅ √ó V‚ÇÅ = C‚ÇÇ √ó V‚ÇÇ<br>
                            50 √ó 0,1 = C‚ÇÇ √ó 0,5<br>
                            5 = C‚ÇÇ √ó 0,5<br>
                            C‚ÇÇ = 5 / 0,5 = <strong>10 g/L</strong><br><br>
                            O suco ficou 5 vezes menos concentrado!
                        </div>
                    </div>
                    
                    <div class="ajuda-dica">
                        üí° <strong>Por que funciona?</strong> A quantidade de soluto (C√óV) n√£o muda, 
                        s√≥ o volume aumenta. √â como dividir uma pizza em mais fatias - a pizza √© a mesma, 
                        mas cada fatia fica menor!
                    </div>
                `
            },
            'massa-molar': {
                titulo: 'Massa Molar (g/mol)',
                conteudo: `
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üìö O que √©?</div>
                        <div class="ajuda-texto">
                            A <strong>massa molar</strong> √© a massa de <strong>1 mol</strong> de uma subst√¢ncia, 
                            expressa em <strong>g/mol</strong>. Para calcular, somamos as massas at√¥micas de todos 
                            os √°tomos que formam a mol√©cula.
                        </div>
                    </div>
                    
                    <div class="ajuda-formula-destaque">MM = Œ£ (massa at√¥mica √ó quantidade)</div>
                    
                    <div class="ajuda-secao">
                        <div class="ajuda-titulo">üî§ Como calcular?</div>
                        <div class="ajuda-texto">
                            1. Identifique todos os elementos na f√≥rmula<br>
                            2. Conte quantos √°tomos de cada elemento existem<br>
                            3. Multiplique a massa at√¥mica pela quantidade<br>
                            4. Some tudo!
                        </div>
                    </div>
                    
                    <div class="ajuda-exemplo">
                        <div class="ajuda-exemplo-titulo">üß™ Exemplo - √Ågua (H‚ÇÇO):</div>
                        <div class="ajuda-exemplo-texto">
                            <strong>H‚ÇÇO</strong> tem: 2 √°tomos de H + 1 √°tomo de O<br><br>
                            Hidrog√™nio (H): 1 g/mol √ó 2 = 2 g/mol<br>
                            Oxig√™nio (O): 16 g/mol √ó 1 = 16 g/mol<br><br>
                            <strong>MM(H‚ÇÇO) = 2 + 16 = 18 g/mol</strong><br><br>
                            Isso significa que 1 mol de √°gua (6√ó10¬≤¬≥ mol√©culas) pesa 18 gramas!
                        </div>
                    </div>
                    
                    <div class="ajuda-exemplo">
                        <div class="ajuda-exemplo-titulo">üß™ Exemplo - √Åcido Sulf√∫rico (H‚ÇÇSO‚ÇÑ):</div>
                        <div class="ajuda-exemplo-texto">
                            H: 1 √ó 2 = 2 g/mol<br>
                            S: 32 √ó 1 = 32 g/mol<br>
                            O: 16 √ó 4 = 64 g/mol<br><br>
                            <strong>MM(H‚ÇÇSO‚ÇÑ) = 2 + 32 + 64 = 98 g/mol</strong>
                        </div>
                    </div>
                    
                    <div class="ajuda-dica">
                        üí° <strong>Dica:</strong> As massas at√¥micas est√£o na tabela peri√≥dica! 
                        As mais comuns: H=1, C=12, N=14, O=16, S=32, Cl=35,5, Na=23, Ca=40.
                    </div>
                `
            }
        };

        // Fun√ß√µes do Modal de Ajuda
        function showAjuda(tipo) {
            const ajuda = ajudaConteudos[tipo];
            if (!ajuda) return;
            
            document.getElementById('modal-ajuda-titulo').textContent = ajuda.titulo;
            document.getElementById('modal-ajuda-body').innerHTML = ajuda.conteudo;
            document.getElementById('modal-ajuda').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModalAjuda() {
            document.getElementById('modal-ajuda').classList.remove('show');
            document.body.style.overflow = '';
        }

        function closeModalAjudaOutside(event) {
            if (event.target.classList.contains('modal-ajuda-overlay')) {
                closeModalAjuda();
            }
        }

        function showResult(elementId, message, isSuccess = true) {
            const el = document.getElementById(elementId);
            el.textContent = message;
            el.className = 'result show ' + (isSuccess ? 'success' : 'error');
        }

        // Fun√ß√£o para salvar e mostrar o bot√£o de desenvolvimento
        function saveDesenvolvimento(prefix, data) {
            desenvolvimentoData[prefix] = data;
            const btn = document.getElementById(`${prefix}-btn-dev`);
            if (btn) {
                btn.classList.add('show');
            }
        }

        // Fun√ß√£o para esconder o bot√£o de desenvolvimento
        function hideDesenvolvimento(prefix) {
            desenvolvimentoData[prefix] = null;
            const btn = document.getElementById(`${prefix}-btn-dev`);
            if (btn) {
                btn.classList.remove('show');
            }
        }

        // Fun√ß√£o para abrir o modal de desenvolvimento
        function showDesenvolvimento(prefix) {
            const data = desenvolvimentoData[prefix];
            if (!data) return;

            const modalBody = document.getElementById('modal-body-content');
            let html = '';

            data.steps.forEach((step, index) => {
                const isLast = index === data.steps.length - 1;
                html += `
                    <div class="desenvolvimento-step">
                        <div class="step-title">
                            <span class="step-number">${index + 1}</span>
                            ${step.titulo}
                        </div>
                        ${step.formula ? `<div class="step-formula${isLast ? ' highlight' : ''}">${step.formula}</div>` : ''}
                        ${step.descricao ? `<div class="step-description">${step.descricao}</div>` : ''}
                    </div>
                `;
            });

            modalBody.innerHTML = html;
            document.getElementById('modal-desenvolvimento').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        // Fechar modal
        function closeModal() {
            document.getElementById('modal-desenvolvimento').classList.remove('show');
            document.body.style.overflow = '';
        }

        // Fechar modal clicando fora
        function closeModalOutside(event) {
            if (event.target.classList.contains('modal-overlay')) {
                closeModal();
            }
        }

        // Fechar modais com ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
                closeModalAjuda();
            }
        });

        function clearFields(prefix) {
            const inputs = document.querySelectorAll(`[id^="${prefix}-"]`);
            inputs.forEach(input => {
                if (input.tagName === 'INPUT') {
                    input.value = '';
                    input.classList.remove('calculated');
                }
            });
            const result = document.getElementById(`${prefix}-result`);
            if (result) {
                result.classList.remove('show');
            }
            hideDesenvolvimento(prefix);
        }

        function getValue(id) {
            const val = document.getElementById(id).value;
            return val === '' ? null : parseFloat(val);
        }

        function getValueWithUnit(id, unitId) {
            const val = getValue(id);
            if (val === null) return null;
            const unit = parseFloat(document.getElementById(unitId).value);
            return val * unit;
        }

        function setCalculated(id, value) {
            const input = document.getElementById(id);
            input.value = formatNumber(value);
            input.classList.add('calculated');
        }

        // Fun√ß√£o para definir valor calculado considerando a unidade selecionada
        function setCalculatedWithUnit(id, valueInBase, unitId) {
            const input = document.getElementById(id);
            const unitFactor = parseFloat(document.getElementById(unitId).value);
            const valueInUnit = valueInBase / unitFactor;
            input.value = formatNumber(valueInUnit);
            input.classList.add('calculated');
            return valueInUnit;
        }

        // Fun√ß√£o para obter o texto da unidade selecionada
        function getUnitLabel(unitId) {
            const select = document.getElementById(unitId);
            return select.options[select.selectedIndex].text;
        }

        // Fun√ß√£o para formatar n√∫meros de forma leg√≠vel
        function formatNumber(value) {
            if (value === 0) return '0';
            const abs = Math.abs(value);
            if (abs >= 0.001 && abs < 1000000) {
                // Para n√∫meros normais, usar at√© 6 casas decimais significativas
                const formatted = parseFloat(value.toPrecision(6));
                return formatted.toString();
            } else {
                // Para n√∫meros muito grandes ou pequenos, usar nota√ß√£o cient√≠fica
                return value.toExponential(4);
            }
        }

        // Concentra√ß√£o Comum: C = m / V
        function calcConcComum() {
            const C = getValueWithUnit('cc-conc', 'cc-conc-unit');
            const m = getValueWithUnit('cc-massa', 'cc-massa-unit');
            const V = getValueWithUnit('cc-volume', 'cc-volume-unit');

            const nullCount = [C, m, V].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('cc-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideDesenvolvimento('cc');
                return;
            }
            if (nullCount > 1) {
                showResult('cc-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideDesenvolvimento('cc');
                return;
            }

            let devSteps = [];
            
            if (C === null) {
                if (V === 0) {
                    showResult('cc-result', '‚ùå Volume n√£o pode ser zero!', false);
                    hideDesenvolvimento('cc');
                    return;
                }
                const resultBase = m / V;
                const resultDisplay = setCalculatedWithUnit('cc-conc', resultBase, 'cc-conc-unit');
                const unitLabel = getUnitLabel('cc-conc-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'C = m / V', descricao: 'Concentra√ß√£o √© igual √† massa dividida pelo volume' },
                    { titulo: 'Substituir os valores', formula: `C = ${formatNumber(m)} g / ${formatNumber(V)} L`, descricao: 'Substituindo os valores fornecidos na f√≥rmula' },
                    { titulo: 'Calcular o resultado', formula: `C = ${formatNumber(resultBase)} g/L`, descricao: 'Realizando a divis√£o' },
                    { titulo: 'Resultado Final', formula: `C = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Convertendo para a unidade selecionada' }
                ];
                
                showResult('cc-result', `‚úì Concentra√ß√£o = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else if (m === null) {
                const resultBase = C * V;
                const resultDisplay = setCalculatedWithUnit('cc-massa', resultBase, 'cc-massa-unit');
                const unitLabel = getUnitLabel('cc-massa-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'C = m / V ‚Üí m = C √ó V', descricao: 'Isolando a massa na f√≥rmula da concentra√ß√£o' },
                    { titulo: 'Substituir os valores', formula: `m = ${formatNumber(C)} g/L √ó ${formatNumber(V)} L`, descricao: 'Substituindo os valores fornecidos na f√≥rmula' },
                    { titulo: 'Calcular o resultado', formula: `m = ${formatNumber(resultBase)} g`, descricao: 'Realizando a multiplica√ß√£o' },
                    { titulo: 'Resultado Final', formula: `m = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Convertendo para a unidade selecionada' }
                ];
                
                showResult('cc-result', `‚úì Massa = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                if (C === 0) {
                    showResult('cc-result', '‚ùå Concentra√ß√£o n√£o pode ser zero!', false);
                    hideDesenvolvimento('cc');
                    return;
                }
                const resultBase = m / C;
                const resultDisplay = setCalculatedWithUnit('cc-volume', resultBase, 'cc-volume-unit');
                const unitLabel = getUnitLabel('cc-volume-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'C = m / V ‚Üí V = m / C', descricao: 'Isolando o volume na f√≥rmula da concentra√ß√£o' },
                    { titulo: 'Substituir os valores', formula: `V = ${formatNumber(m)} g / ${formatNumber(C)} g/L`, descricao: 'Substituindo os valores fornecidos na f√≥rmula' },
                    { titulo: 'Calcular o resultado', formula: `V = ${formatNumber(resultBase)} L`, descricao: 'Realizando a divis√£o' },
                    { titulo: 'Resultado Final', formula: `V = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Convertendo para a unidade selecionada' }
                ];
                
                showResult('cc-result', `‚úì Volume = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            
            saveDesenvolvimento('cc', { steps: devSteps });
        }

        // Molar: M = m / (MM √ó V)
        function calcMolar() {
            const M = getValue('m-molar');
            const m = getValueWithUnit('m-massa', 'm-massa-unit');
            const MM = getValue('m-mm');
            const V = getValueWithUnit('m-volume', 'm-volume-unit');

            if (!MM || MM === 0) {
                showResult('m-result', '‚ùå Massa Molar √© obrigat√≥ria!', false);
                hideDesenvolvimento('m');
                return;
            }

            const nullCount = [M, m, V].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('m-result', '‚ùå Deixe UM campo em branco (exceto MM)!', false);
                hideDesenvolvimento('m');
                return;
            }
            if (nullCount > 1) {
                showResult('m-result', '‚ùå Preencha pelo menos 2 valores (al√©m de MM)!', false);
                hideDesenvolvimento('m');
                return;
            }

            let devSteps = [];

            if (M === null) {
                if (V === 0) {
                    showResult('m-result', '‚ùå Volume n√£o pode ser zero!', false);
                    hideDesenvolvimento('m');
                    return;
                }
                const result = m / (MM * V);
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'M = m / (MM √ó V)', descricao: 'Molaridade √© igual √† massa dividida pelo produto da massa molar e volume' },
                    { titulo: 'Identificar os valores', formula: `m = ${formatNumber(m)} g | MM = ${formatNumber(MM)} g/mol | V = ${formatNumber(V)} L`, descricao: 'Valores fornecidos' },
                    { titulo: 'Substituir na f√≥rmula', formula: `M = ${formatNumber(m)} / (${formatNumber(MM)} √ó ${formatNumber(V)})`, descricao: 'Substituindo os valores na f√≥rmula' },
                    { titulo: 'Calcular o denominador', formula: `M = ${formatNumber(m)} / ${formatNumber(MM * V)}`, descricao: `Multiplicando MM √ó V = ${formatNumber(MM * V)}` },
                    { titulo: 'Resultado Final', formula: `M = ${formatNumber(result)} mol/L`, descricao: 'Realizando a divis√£o final' }
                ];
                
                setCalculated('m-molar', result);
                showResult('m-result', `‚úì Molaridade = ${formatNumber(result)} mol/L`);
            } else if (m === null) {
                const resultBase = M * MM * V;
                const resultDisplay = setCalculatedWithUnit('m-massa', resultBase, 'm-massa-unit');
                const unitLabel = getUnitLabel('m-massa-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'M = m / (MM √ó V) ‚Üí m = M √ó MM √ó V', descricao: 'Isolando a massa na f√≥rmula da molaridade' },
                    { titulo: 'Identificar os valores', formula: `M = ${formatNumber(M)} mol/L | MM = ${formatNumber(MM)} g/mol | V = ${formatNumber(V)} L`, descricao: 'Valores fornecidos' },
                    { titulo: 'Substituir na f√≥rmula', formula: `m = ${formatNumber(M)} √ó ${formatNumber(MM)} √ó ${formatNumber(V)}`, descricao: 'Substituindo os valores na f√≥rmula' },
                    { titulo: 'Calcular o resultado', formula: `m = ${formatNumber(resultBase)} g`, descricao: 'Realizando as multiplica√ß√µes' },
                    { titulo: 'Resultado Final', formula: `m = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Convertendo para a unidade selecionada' }
                ];
                
                showResult('m-result', `‚úì Massa = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                if (M === 0) {
                    showResult('m-result', '‚ùå Molaridade n√£o pode ser zero!', false);
                    hideDesenvolvimento('m');
                    return;
                }
                const resultBase = m / (M * MM);
                const resultDisplay = setCalculatedWithUnit('m-volume', resultBase, 'm-volume-unit');
                const unitLabel = getUnitLabel('m-volume-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'M = m / (MM √ó V) ‚Üí V = m / (M √ó MM)', descricao: 'Isolando o volume na f√≥rmula da molaridade' },
                    { titulo: 'Identificar os valores', formula: `m = ${formatNumber(m)} g | M = ${formatNumber(M)} mol/L | MM = ${formatNumber(MM)} g/mol`, descricao: 'Valores fornecidos' },
                    { titulo: 'Substituir na f√≥rmula', formula: `V = ${formatNumber(m)} / (${formatNumber(M)} √ó ${formatNumber(MM)})`, descricao: 'Substituindo os valores na f√≥rmula' },
                    { titulo: 'Calcular o denominador', formula: `V = ${formatNumber(m)} / ${formatNumber(M * MM)}`, descricao: `Multiplicando M √ó MM = ${formatNumber(M * MM)}` },
                    { titulo: 'Resultado Final', formula: `V = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Realizando a divis√£o e convertendo' }
                ];
                
                showResult('m-result', `‚úì Volume = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            
            saveDesenvolvimento('m', { steps: devSteps });
        }

        function updatePorcentagemLabels() {
            const tipo = document.getElementById('p-tipo').value;
            const label1 = document.getElementById('p-label1');
            const label2 = document.getElementById('p-label2');
            const unit1 = document.getElementById('p-unit1');
            const unit2 = document.getElementById('p-unit2');
            
            unit1.innerHTML = '';
            unit2.innerHTML = '';
            
            if (tipo === 'mm') {
                label1.textContent = 'Massa do soluto';
                label2.textContent = 'Massa da solu√ß√£o';
                unit1.innerHTML = '<option value="1">g</option><option value="0.001">mg</option><option value="1000">kg</option>';
                unit2.innerHTML = '<option value="1">g</option><option value="0.001">mg</option><option value="1000">kg</option>';
            } else if (tipo === 'vv') {
                label1.textContent = 'Volume do soluto';
                label2.textContent = 'Volume da solu√ß√£o';
                unit1.innerHTML = '<option value="1">mL</option><option value="1000">L</option>';
                unit2.innerHTML = '<option value="1">mL</option><option value="1000">L</option>';
            } else {
                label1.textContent = 'Massa do soluto';
                label2.textContent = 'Volume da solu√ß√£o';
                unit1.innerHTML = '<option value="1">g</option><option value="0.001">mg</option><option value="1000">kg</option>';
                unit2.innerHTML = '<option value="1">mL</option><option value="1000">L</option>';
            }
        }

        // Porcentagem: % = (parte / total) √ó 100
        function calcPorcentagem() {
            const perc = getValue('p-perc');
            const val1 = getValueWithUnit('p-val1', 'p-unit1');
            const val2 = getValueWithUnit('p-val2', 'p-unit2');
            const tipo = document.getElementById('p-tipo').value;

            const nullCount = [perc, val1, val2].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('p-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideDesenvolvimento('p');
                return;
            }
            if (nullCount > 1) {
                showResult('p-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideDesenvolvimento('p');
                return;
            }

            let tipoTexto = tipo === 'mm' ? 'm/m' : (tipo === 'vv' ? 'v/v' : 'm/v');
            let unidadeBase1 = tipo === 'vv' ? 'mL' : 'g';
            let unidadeBase2 = tipo === 'mm' ? 'g' : 'mL';
            
            let devSteps = [];

            if (perc === null) {
                if (val2 === 0) {
                    showResult('p-result', '‚ùå O total n√£o pode ser zero!', false);
                    hideDesenvolvimento('p');
                    return;
                }
                const result = (val1 / val2) * 100;
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: '% = (parte / total) √ó 100', descricao: `F√≥rmula da concentra√ß√£o percentual ${tipoTexto}` },
                    { titulo: 'Identificar os valores', formula: `Parte = ${formatNumber(val1)} ${unidadeBase1} | Total = ${formatNumber(val2)} ${unidadeBase2}`, descricao: 'Valores fornecidos' },
                    { titulo: 'Substituir na f√≥rmula', formula: `% = (${formatNumber(val1)} / ${formatNumber(val2)}) √ó 100`, descricao: 'Substituindo os valores' },
                    { titulo: 'Calcular a divis√£o', formula: `% = ${formatNumber(val1 / val2)} √ó 100`, descricao: 'Realizando a divis√£o' },
                    { titulo: 'Resultado Final', formula: `% = ${formatNumber(result)}%`, descricao: 'Multiplicando por 100' }
                ];
                
                setCalculated('p-perc', result);
                showResult('p-result', `‚úì ${tipoTexto} = ${formatNumber(result)} %`);
            } else if (val1 === null) {
                const resultBase = (perc * val2) / 100;
                const resultDisplay = setCalculatedWithUnit('p-val1', resultBase, 'p-unit1');
                const unitLabel = getUnitLabel('p-unit1');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: '% = (parte / total) √ó 100 ‚Üí parte = (% √ó total) / 100', descricao: 'Isolando a parte na f√≥rmula' },
                    { titulo: 'Identificar os valores', formula: `% = ${formatNumber(perc)} | Total = ${formatNumber(val2)} ${unidadeBase2}`, descricao: 'Valores fornecidos' },
                    { titulo: 'Substituir na f√≥rmula', formula: `parte = (${formatNumber(perc)} √ó ${formatNumber(val2)}) / 100`, descricao: 'Substituindo os valores' },
                    { titulo: 'Calcular o numerador', formula: `parte = ${formatNumber(perc * val2)} / 100`, descricao: 'Realizando a multiplica√ß√£o' },
                    { titulo: 'Resultado Final', formula: `parte = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Dividindo por 100 e convertendo' }
                ];
                
                showResult('p-result', `‚úì Parte = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                if (perc === 0) {
                    showResult('p-result', '‚ùå Porcentagem n√£o pode ser zero!', false);
                    hideDesenvolvimento('p');
                    return;
                }
                const resultBase = (val1 * 100) / perc;
                const resultDisplay = setCalculatedWithUnit('p-val2', resultBase, 'p-unit2');
                const unitLabel = getUnitLabel('p-unit2');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: '% = (parte / total) √ó 100 ‚Üí total = (parte √ó 100) / %', descricao: 'Isolando o total na f√≥rmula' },
                    { titulo: 'Identificar os valores', formula: `Parte = ${formatNumber(val1)} ${unidadeBase1} | % = ${formatNumber(perc)}`, descricao: 'Valores fornecidos' },
                    { titulo: 'Substituir na f√≥rmula', formula: `total = (${formatNumber(val1)} √ó 100) / ${formatNumber(perc)}`, descricao: 'Substituindo os valores' },
                    { titulo: 'Calcular o numerador', formula: `total = ${formatNumber(val1 * 100)} / ${formatNumber(perc)}`, descricao: 'Multiplicando por 100' },
                    { titulo: 'Resultado Final', formula: `total = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Dividindo e convertendo' }
                ];
                
                showResult('p-result', `‚úì Total = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            
            saveDesenvolvimento('p', { steps: devSteps });
        }

        // Densidade: d = m / V
        function calcDensidade() {
            const d = getValue('d-dens');
            const m = getValueWithUnit('d-massa', 'd-massa-unit');
            const V = getValueWithUnit('d-volume', 'd-volume-unit');

            const nullCount = [d, m, V].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('d-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideDesenvolvimento('d');
                return;
            }
            if (nullCount > 1) {
                showResult('d-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideDesenvolvimento('d');
                return;
            }

            let devSteps = [];

            if (d === null) {
                if (V === 0) {
                    showResult('d-result', '‚ùå Volume n√£o pode ser zero!', false);
                    hideDesenvolvimento('d');
                    return;
                }
                const result = m / V;
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'd = m / V', descricao: 'Densidade √© igual √† massa dividida pelo volume' },
                    { titulo: 'Identificar os valores', formula: `m = ${formatNumber(m)} g | V = ${formatNumber(V)} mL`, descricao: 'Valores fornecidos' },
                    { titulo: 'Substituir na f√≥rmula', formula: `d = ${formatNumber(m)} / ${formatNumber(V)}`, descricao: 'Substituindo os valores' },
                    { titulo: 'Resultado Final', formula: `d = ${formatNumber(result)} g/mL`, descricao: 'Realizando a divis√£o' }
                ];
                
                setCalculated('d-dens', result);
                showResult('d-result', `‚úì Densidade = ${formatNumber(result)} g/mL`);
            } else if (m === null) {
                const resultBase = d * V;
                const resultDisplay = setCalculatedWithUnit('d-massa', resultBase, 'd-massa-unit');
                const unitLabel = getUnitLabel('d-massa-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'd = m / V ‚Üí m = d √ó V', descricao: 'Isolando a massa na f√≥rmula da densidade' },
                    { titulo: 'Identificar os valores', formula: `d = ${formatNumber(d)} g/mL | V = ${formatNumber(V)} mL`, descricao: 'Valores fornecidos' },
                    { titulo: 'Substituir na f√≥rmula', formula: `m = ${formatNumber(d)} √ó ${formatNumber(V)}`, descricao: 'Substituindo os valores' },
                    { titulo: 'Calcular o resultado', formula: `m = ${formatNumber(resultBase)} g`, descricao: 'Realizando a multiplica√ß√£o' },
                    { titulo: 'Resultado Final', formula: `m = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Convertendo para a unidade selecionada' }
                ];
                
                showResult('d-result', `‚úì Massa = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                if (d === 0) {
                    showResult('d-result', '‚ùå Densidade n√£o pode ser zero!', false);
                    hideDesenvolvimento('d');
                    return;
                }
                const resultBase = m / d;
                const resultDisplay = setCalculatedWithUnit('d-volume', resultBase, 'd-volume-unit');
                const unitLabel = getUnitLabel('d-volume-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'd = m / V ‚Üí V = m / d', descricao: 'Isolando o volume na f√≥rmula da densidade' },
                    { titulo: 'Identificar os valores', formula: `m = ${formatNumber(m)} g | d = ${formatNumber(d)} g/mL`, descricao: 'Valores fornecidos' },
                    { titulo: 'Substituir na f√≥rmula', formula: `V = ${formatNumber(m)} / ${formatNumber(d)}`, descricao: 'Substituindo os valores' },
                    { titulo: 'Calcular o resultado', formula: `V = ${formatNumber(resultBase)} mL`, descricao: 'Realizando a divis√£o' },
                    { titulo: 'Resultado Final', formula: `V = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Convertendo para a unidade selecionada' }
                ];
                
                showResult('d-result', `‚úì Volume = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            
            saveDesenvolvimento('d', { steps: devSteps });
        }

        // Fra√ß√£o Molar: X‚ÇÅ = n‚ÇÅ / (n‚ÇÅ + n‚ÇÇ)
        function calcFracaoMolar() {
            const X = getValue('f-x');
            const n1 = getValue('f-n1');
            const n2 = getValue('f-n2');

            const nullCount = [X, n1, n2].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('f-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideDesenvolvimento('f');
                return;
            }
            if (nullCount > 1) {
                showResult('f-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideDesenvolvimento('f');
                return;
            }

            let devSteps = [];

            if (X === null) {
                if (n1 + n2 === 0) {
                    showResult('f-result', '‚ùå Soma dos mols n√£o pode ser zero!', false);
                    hideDesenvolvimento('f');
                    return;
                }
                const result = n1 / (n1 + n2);
                const x2 = 1 - result;
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'X‚ÇÅ = n‚ÇÅ / (n‚ÇÅ + n‚ÇÇ)', descricao: 'Fra√ß√£o molar do soluto' },
                    { titulo: 'Identificar os valores', formula: `n‚ÇÅ = ${formatNumber(n1)} mol | n‚ÇÇ = ${formatNumber(n2)} mol`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular o denominador', formula: `n‚ÇÅ + n‚ÇÇ = ${formatNumber(n1)} + ${formatNumber(n2)} = ${formatNumber(n1 + n2)} mol`, descricao: 'Soma dos mols' },
                    { titulo: 'Substituir e calcular', formula: `X‚ÇÅ = ${formatNumber(n1)} / ${formatNumber(n1 + n2)} = ${formatNumber(result)}`, descricao: 'Realizando a divis√£o' },
                    { titulo: 'Calcular X‚ÇÇ', formula: `X‚ÇÇ = 1 - X‚ÇÅ = 1 - ${formatNumber(result)} = ${formatNumber(x2)}`, descricao: 'Fra√ß√£o molar do solvente' },
                    { titulo: 'Resultado Final', formula: `X‚ÇÅ = ${formatNumber(result)} | X‚ÇÇ = ${formatNumber(x2)}`, descricao: 'X‚ÇÅ + X‚ÇÇ = 1' }
                ];
                
                setCalculated('f-x', result);
                showResult('f-result', `‚úì X‚ÇÅ = ${formatNumber(result)} | X‚ÇÇ = ${formatNumber(x2)}`);
            } else if (n1 === null) {
                if (X >= 1) {
                    showResult('f-result', '‚ùå Fra√ß√£o molar deve ser menor que 1!', false);
                    hideDesenvolvimento('f');
                    return;
                }
                const result = (X * n2) / (1 - X);
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'X‚ÇÅ = n‚ÇÅ / (n‚ÇÅ + n‚ÇÇ) ‚Üí n‚ÇÅ = (X‚ÇÅ √ó n‚ÇÇ) / (1 - X‚ÇÅ)', descricao: 'Isolando n‚ÇÅ na f√≥rmula' },
                    { titulo: 'Identificar os valores', formula: `X‚ÇÅ = ${formatNumber(X)} | n‚ÇÇ = ${formatNumber(n2)} mol`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular o numerador', formula: `X‚ÇÅ √ó n‚ÇÇ = ${formatNumber(X)} √ó ${formatNumber(n2)} = ${formatNumber(X * n2)}`, descricao: 'Multiplica√ß√£o' },
                    { titulo: 'Calcular o denominador', formula: `1 - X‚ÇÅ = 1 - ${formatNumber(X)} = ${formatNumber(1 - X)}`, descricao: 'Subtra√ß√£o' },
                    { titulo: 'Resultado Final', formula: `n‚ÇÅ = ${formatNumber(X * n2)} / ${formatNumber(1 - X)} = ${formatNumber(result)} mol`, descricao: 'Divis√£o final' }
                ];
                
                setCalculated('f-n1', result);
                showResult('f-result', `‚úì n‚ÇÅ = ${formatNumber(result)} mol`);
            } else {
                if (X === 0) {
                    showResult('f-result', '‚ùå Fra√ß√£o molar n√£o pode ser zero!', false);
                    hideDesenvolvimento('f');
                    return;
                }
                const result = n1 * (1 - X) / X;
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'X‚ÇÅ = n‚ÇÅ / (n‚ÇÅ + n‚ÇÇ) ‚Üí n‚ÇÇ = n‚ÇÅ √ó (1 - X‚ÇÅ) / X‚ÇÅ', descricao: 'Isolando n‚ÇÇ na f√≥rmula' },
                    { titulo: 'Identificar os valores', formula: `n‚ÇÅ = ${formatNumber(n1)} mol | X‚ÇÅ = ${formatNumber(X)}`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular (1 - X‚ÇÅ)', formula: `1 - X‚ÇÅ = 1 - ${formatNumber(X)} = ${formatNumber(1 - X)}`, descricao: 'Subtra√ß√£o' },
                    { titulo: 'Calcular o numerador', formula: `n‚ÇÅ √ó (1 - X‚ÇÅ) = ${formatNumber(n1)} √ó ${formatNumber(1 - X)} = ${formatNumber(n1 * (1 - X))}`, descricao: 'Multiplica√ß√£o' },
                    { titulo: 'Resultado Final', formula: `n‚ÇÇ = ${formatNumber(n1 * (1 - X))} / ${formatNumber(X)} = ${formatNumber(result)} mol`, descricao: 'Divis√£o final' }
                ];
                
                setCalculated('f-n2', result);
                showResult('f-result', `‚úì n‚ÇÇ = ${formatNumber(result)} mol`);
            }
            
            saveDesenvolvimento('f', { steps: devSteps });
        }

        // Solubilidade: Cs = (soluto / solvente) √ó 100
        function calcSolubilidade() {
            const Cs = getValue('s-cs');
            const soluto = getValueWithUnit('s-soluto', 's-soluto-unit');
            const solvente = getValueWithUnit('s-solvente', 's-solvente-unit');

            const nullCount = [Cs, soluto, solvente].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('s-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideDesenvolvimento('s');
                return;
            }
            if (nullCount > 1) {
                showResult('s-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideDesenvolvimento('s');
                return;
            }

            let devSteps = [];

            if (Cs === null) {
                if (solvente === 0) {
                    showResult('s-result', '‚ùå Massa do solvente n√£o pode ser zero!', false);
                    hideDesenvolvimento('s');
                    return;
                }
                const result = (soluto / solvente) * 100;
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'Cs = (soluto / solvente) √ó 100', descricao: 'Coeficiente de solubilidade em g/100g de solvente' },
                    { titulo: 'Identificar os valores', formula: `Soluto = ${formatNumber(soluto)} g | Solvente = ${formatNumber(solvente)} g`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular a divis√£o', formula: `Soluto / Solvente = ${formatNumber(soluto)} / ${formatNumber(solvente)} = ${formatNumber(soluto / solvente)}`, descricao: 'Dividindo as massas' },
                    { titulo: 'Resultado Final', formula: `Cs = ${formatNumber(soluto / solvente)} √ó 100 = ${formatNumber(result)} g/100g`, descricao: 'Multiplicando por 100' }
                ];
                
                setCalculated('s-cs', result);
                showResult('s-result', `‚úì Cs = ${formatNumber(result)} g/100g de solvente`);
            } else if (soluto === null) {
                const resultBase = (Cs * solvente) / 100;
                const resultDisplay = setCalculatedWithUnit('s-soluto', resultBase, 's-soluto-unit');
                const unitLabel = getUnitLabel('s-soluto-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'Cs = (soluto / solvente) √ó 100 ‚Üí soluto = (Cs √ó solvente) / 100', descricao: 'Isolando a massa de soluto' },
                    { titulo: 'Identificar os valores', formula: `Cs = ${formatNumber(Cs)} g/100g | Solvente = ${formatNumber(solvente)} g`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular o numerador', formula: `Cs √ó Solvente = ${formatNumber(Cs)} √ó ${formatNumber(solvente)} = ${formatNumber(Cs * solvente)}`, descricao: 'Multiplica√ß√£o' },
                    { titulo: 'Resultado Final', formula: `Soluto = ${formatNumber(Cs * solvente)} / 100 = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Dividindo por 100 e convertendo' }
                ];
                
                showResult('s-result', `‚úì Massa de soluto = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                if (Cs === 0) {
                    showResult('s-result', '‚ùå Coeficiente n√£o pode ser zero!', false);
                    hideDesenvolvimento('s');
                    return;
                }
                const resultBase = (soluto * 100) / Cs;
                const resultDisplay = setCalculatedWithUnit('s-solvente', resultBase, 's-solvente-unit');
                const unitLabel = getUnitLabel('s-solvente-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'Cs = (soluto / solvente) √ó 100 ‚Üí solvente = (soluto √ó 100) / Cs', descricao: 'Isolando a massa de solvente' },
                    { titulo: 'Identificar os valores', formula: `Soluto = ${formatNumber(soluto)} g | Cs = ${formatNumber(Cs)} g/100g`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular o numerador', formula: `Soluto √ó 100 = ${formatNumber(soluto)} √ó 100 = ${formatNumber(soluto * 100)}`, descricao: 'Multiplicando por 100' },
                    { titulo: 'Resultado Final', formula: `Solvente = ${formatNumber(soluto * 100)} / ${formatNumber(Cs)} = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Dividindo e convertendo' }
                ];
                
                showResult('s-result', `‚úì Massa de solvente = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            
            saveDesenvolvimento('s', { steps: devSteps });
        }

        // Dilui√ß√£o: C‚ÇÅV‚ÇÅ = C‚ÇÇV‚ÇÇ
        function calcDiluicao() {
            const C1 = getValueWithUnit('dil-c1', 'dil-c1-unit');
            const V1 = getValueWithUnit('dil-v1', 'dil-v1-unit');
            const C2 = getValueWithUnit('dil-c2', 'dil-c2-unit');
            const V2 = getValueWithUnit('dil-v2', 'dil-v2-unit');

            const nullCount = [C1, V1, C2, V2].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('dil-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideDesenvolvimento('dil');
                return;
            }
            if (nullCount > 1) {
                showResult('dil-result', '‚ùå Preencha pelo menos 3 valores!', false);
                hideDesenvolvimento('dil');
                return;
            }

            let devSteps = [];

            if (C1 === null) {
                if (V1 === 0) {
                    showResult('dil-result', '‚ùå V‚ÇÅ n√£o pode ser zero!', false);
                    hideDesenvolvimento('dil');
                    return;
                }
                const resultBase = (C2 * V2) / V1;
                const resultDisplay = setCalculatedWithUnit('dil-c1', resultBase, 'dil-c1-unit');
                const unitLabel = getUnitLabel('dil-c1-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'C‚ÇÅ √ó V‚ÇÅ = C‚ÇÇ √ó V‚ÇÇ', descricao: 'Lei da dilui√ß√£o: o produto concentra√ß√£o √ó volume √© constante' },
                    { titulo: 'Isolar C‚ÇÅ', formula: 'C‚ÇÅ = (C‚ÇÇ √ó V‚ÇÇ) / V‚ÇÅ', descricao: 'Isolando a concentra√ß√£o inicial' },
                    { titulo: 'Identificar os valores', formula: `C‚ÇÇ = ${formatNumber(C2)} | V‚ÇÇ = ${formatNumber(V2)} L | V‚ÇÅ = ${formatNumber(V1)} L`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular o numerador', formula: `C‚ÇÇ √ó V‚ÇÇ = ${formatNumber(C2)} √ó ${formatNumber(V2)} = ${formatNumber(C2 * V2)}`, descricao: 'Multiplica√ß√£o' },
                    { titulo: 'Resultado Final', formula: `C‚ÇÅ = ${formatNumber(C2 * V2)} / ${formatNumber(V1)} = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Divis√£o final' }
                ];
                
                showResult('dil-result', `‚úì C‚ÇÅ = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else if (V1 === null) {
                if (C1 === 0) {
                    showResult('dil-result', '‚ùå C‚ÇÅ n√£o pode ser zero!', false);
                    hideDesenvolvimento('dil');
                    return;
                }
                const resultBase = (C2 * V2) / C1;
                const resultDisplay = setCalculatedWithUnit('dil-v1', resultBase, 'dil-v1-unit');
                const unitLabel = getUnitLabel('dil-v1-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'C‚ÇÅ √ó V‚ÇÅ = C‚ÇÇ √ó V‚ÇÇ', descricao: 'Lei da dilui√ß√£o: o produto concentra√ß√£o √ó volume √© constante' },
                    { titulo: 'Isolar V‚ÇÅ', formula: 'V‚ÇÅ = (C‚ÇÇ √ó V‚ÇÇ) / C‚ÇÅ', descricao: 'Isolando o volume inicial' },
                    { titulo: 'Identificar os valores', formula: `C‚ÇÇ = ${formatNumber(C2)} | V‚ÇÇ = ${formatNumber(V2)} L | C‚ÇÅ = ${formatNumber(C1)}`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular o numerador', formula: `C‚ÇÇ √ó V‚ÇÇ = ${formatNumber(C2)} √ó ${formatNumber(V2)} = ${formatNumber(C2 * V2)}`, descricao: 'Multiplica√ß√£o' },
                    { titulo: 'Resultado Final', formula: `V‚ÇÅ = ${formatNumber(C2 * V2)} / ${formatNumber(C1)} = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Divis√£o final e convers√£o' }
                ];
                
                showResult('dil-result', `‚úì V‚ÇÅ = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else if (C2 === null) {
                if (V2 === 0) {
                    showResult('dil-result', '‚ùå V‚ÇÇ n√£o pode ser zero!', false);
                    hideDesenvolvimento('dil');
                    return;
                }
                const resultBase = (C1 * V1) / V2;
                const resultDisplay = setCalculatedWithUnit('dil-c2', resultBase, 'dil-c2-unit');
                const unitLabel = getUnitLabel('dil-c2-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'C‚ÇÅ √ó V‚ÇÅ = C‚ÇÇ √ó V‚ÇÇ', descricao: 'Lei da dilui√ß√£o: o produto concentra√ß√£o √ó volume √© constante' },
                    { titulo: 'Isolar C‚ÇÇ', formula: 'C‚ÇÇ = (C‚ÇÅ √ó V‚ÇÅ) / V‚ÇÇ', descricao: 'Isolando a concentra√ß√£o final' },
                    { titulo: 'Identificar os valores', formula: `C‚ÇÅ = ${formatNumber(C1)} | V‚ÇÅ = ${formatNumber(V1)} L | V‚ÇÇ = ${formatNumber(V2)} L`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular o numerador', formula: `C‚ÇÅ √ó V‚ÇÅ = ${formatNumber(C1)} √ó ${formatNumber(V1)} = ${formatNumber(C1 * V1)}`, descricao: 'Multiplica√ß√£o' },
                    { titulo: 'Resultado Final', formula: `C‚ÇÇ = ${formatNumber(C1 * V1)} / ${formatNumber(V2)} = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Divis√£o final' }
                ];
                
                showResult('dil-result', `‚úì C‚ÇÇ = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                if (C2 === 0) {
                    showResult('dil-result', '‚ùå C‚ÇÇ n√£o pode ser zero!', false);
                    hideDesenvolvimento('dil');
                    return;
                }
                const resultBase = (C1 * V1) / C2;
                const resultDisplay = setCalculatedWithUnit('dil-v2', resultBase, 'dil-v2-unit');
                const unitLabel = getUnitLabel('dil-v2-unit');
                
                devSteps = [
                    { titulo: 'Identificar a f√≥rmula', formula: 'C‚ÇÅ √ó V‚ÇÅ = C‚ÇÇ √ó V‚ÇÇ', descricao: 'Lei da dilui√ß√£o: o produto concentra√ß√£o √ó volume √© constante' },
                    { titulo: 'Isolar V‚ÇÇ', formula: 'V‚ÇÇ = (C‚ÇÅ √ó V‚ÇÅ) / C‚ÇÇ', descricao: 'Isolando o volume final' },
                    { titulo: 'Identificar os valores', formula: `C‚ÇÅ = ${formatNumber(C1)} | V‚ÇÅ = ${formatNumber(V1)} L | C‚ÇÇ = ${formatNumber(C2)}`, descricao: 'Valores fornecidos' },
                    { titulo: 'Calcular o numerador', formula: `C‚ÇÅ √ó V‚ÇÅ = ${formatNumber(C1)} √ó ${formatNumber(V1)} = ${formatNumber(C1 * V1)}`, descricao: 'Multiplica√ß√£o' },
                    { titulo: 'Resultado Final', formula: `V‚ÇÇ = ${formatNumber(C1 * V1)} / ${formatNumber(C2)} = ${formatNumber(resultDisplay)} ${unitLabel}`, descricao: 'Divis√£o final e convers√£o' }
                ];
                
                showResult('dil-result', `‚úì V‚ÇÇ = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            
            saveDesenvolvimento('dil', { steps: devSteps });
        }

        // Tabela de Massas At√¥micas
        const elementosMassas = {
            'H': { nome: 'Hidrog√™nio', massa: 1.008 },
            'He': { nome: 'H√©lio', massa: 4.003 },
            'Li': { nome: 'L√≠tio', massa: 6.941 },
            'Be': { nome: 'Ber√≠lio', massa: 9.012 },
            'B': { nome: 'Boro', massa: 10.81 },
            'C': { nome: 'Carbono', massa: 12.01 },
            'N': { nome: 'Nitrog√™nio', massa: 14.01 },
            'O': { nome: 'Oxig√™nio', massa: 16.00 },
            'F': { nome: 'Fl√∫or', massa: 19.00 },
            'Ne': { nome: 'Ne√¥nio', massa: 20.18 },
            'Na': { nome: 'S√≥dio', massa: 22.99 },
            'Mg': { nome: 'Magn√©sio', massa: 24.31 },
            'Al': { nome: 'Alum√≠nio', massa: 26.98 },
            'Si': { nome: 'Sil√≠cio', massa: 28.09 },
            'P': { nome: 'F√≥sforo', massa: 30.97 },
            'S': { nome: 'Enxofre', massa: 32.07 },
            'Cl': { nome: 'Cloro', massa: 35.45 },
            'Ar': { nome: 'Arg√¥nio', massa: 39.95 },
            'K': { nome: 'Pot√°ssio', massa: 39.10 },
            'Ca': { nome: 'C√°lcio', massa: 40.08 },
            'Sc': { nome: 'Esc√¢ndio', massa: 44.96 },
            'Ti': { nome: 'Tit√¢nio', massa: 47.87 },
            'V': { nome: 'Van√°dio', massa: 50.94 },
            'Cr': { nome: 'Cromo', massa: 52.00 },
            'Mn': { nome: 'Mangan√™s', massa: 54.94 },
            'Fe': { nome: 'Ferro', massa: 55.85 },
            'Co': { nome: 'Cobalto', massa: 58.93 },
            'Ni': { nome: 'N√≠quel', massa: 58.69 },
            'Cu': { nome: 'Cobre', massa: 63.55 },
            'Zn': { nome: 'Zinco', massa: 65.38 },
            'Ga': { nome: 'G√°lio', massa: 69.72 },
            'Ge': { nome: 'Germ√¢nio', massa: 72.63 },
            'As': { nome: 'Ars√™nio', massa: 74.92 },
            'Se': { nome: 'Sel√™nio', massa: 78.97 },
            'Br': { nome: 'Bromo', massa: 79.90 },
            'Kr': { nome: 'Cript√¥nio', massa: 83.80 },
            'Rb': { nome: 'Rub√≠dio', massa: 85.47 },
            'Sr': { nome: 'Estr√¥ncio', massa: 87.62 },
            'Y': { nome: '√çtrio', massa: 88.91 },
            'Zr': { nome: 'Zirc√¥nio', massa: 91.22 },
            'Nb': { nome: 'Ni√≥bio', massa: 92.91 },
            'Mo': { nome: 'Molibd√™nio', massa: 95.95 },
            'Ru': { nome: 'Rut√™nio', massa: 101.1 },
            'Rh': { nome: 'R√≥dio', massa: 102.9 },
            'Pd': { nome: 'Pal√°dio', massa: 106.4 },
            'Ag': { nome: 'Prata', massa: 107.9 },
            'Cd': { nome: 'C√°dmio', massa: 112.4 },
            'In': { nome: '√çndio', massa: 114.8 },
            'Sn': { nome: 'Estanho', massa: 118.7 },
            'Sb': { nome: 'Antim√¥nio', massa: 121.8 },
            'Te': { nome: 'Tel√∫rio', massa: 127.6 },
            'I': { nome: 'Iodo', massa: 126.9 },
            'Xe': { nome: 'Xen√¥nio', massa: 131.3 },
            'Cs': { nome: 'C√©sio', massa: 132.9 },
            'Ba': { nome: 'B√°rio', massa: 137.3 },
            'La': { nome: 'Lant√¢nio', massa: 138.9 },
            'Ce': { nome: 'C√©rio', massa: 140.1 },
            'Pr': { nome: 'Praseod√≠mio', massa: 140.9 },
            'Nd': { nome: 'Neod√≠mio', massa: 144.2 },
            'Pm': { nome: 'Prom√©cio', massa: 145.0 },
            'Sm': { nome: 'Sam√°rio', massa: 150.4 },
            'Eu': { nome: 'Eur√≥pio', massa: 152.0 },
            'Gd': { nome: 'Gadol√≠nio', massa: 157.3 },
            'Tb': { nome: 'T√©rbio', massa: 158.9 },
            'Dy': { nome: 'Dispr√≥sio', massa: 162.5 },
            'Ho': { nome: 'H√≥lmio', massa: 164.9 },
            'Er': { nome: '√ârbio', massa: 167.3 },
            'Tm': { nome: 'T√∫lio', massa: 168.9 },
            'Yb': { nome: 'It√©rbio', massa: 173.0 },
            'Lu': { nome: 'Lut√©cio', massa: 175.0 },
            'Hf': { nome: 'H√°fnio', massa: 178.5 },
            'Ta': { nome: 'T√¢ntalo', massa: 180.9 },
            'W': { nome: 'Tungst√™nio', massa: 183.8 },
            'Re': { nome: 'R√™nio', massa: 186.2 },
            'Os': { nome: '√ìsmio', massa: 190.2 },
            'Ir': { nome: 'Ir√≠dio', massa: 192.2 },
            'Pt': { nome: 'Platina', massa: 195.1 },
            'Au': { nome: 'Ouro', massa: 197.0 },
            'Hg': { nome: 'Merc√∫rio', massa: 200.6 },
            'Tl': { nome: 'T√°lio', massa: 204.4 },
            'Pb': { nome: 'Chumbo', massa: 207.2 },
            'Bi': { nome: 'Bismuto', massa: 209.0 },
            'Po': { nome: 'Pol√¥nio', massa: 209.0 },
            'At': { nome: 'Astato', massa: 210.0 },
            'Rn': { nome: 'Rad√¥nio', massa: 222.0 },
            'Fr': { nome: 'Fr√¢ncio', massa: 223.0 },
            'Ra': { nome: 'R√°dio', massa: 226.0 },
            'Ac': { nome: 'Act√≠nio', massa: 227.0 },
            'Th': { nome: 'T√≥rio', massa: 232.0 },
            'Pa': { nome: 'Protact√≠nio', massa: 231.0 },
            'U': { nome: 'Ur√¢nio', massa: 238.0 }
        };

        // Parser de f√≥rmulas qu√≠micas
        function parseFormula(formula) {
            const elementos = {};
            
            function parseGroup(str, multiplier = 1) {
                let i = 0;
                while (i < str.length) {
                    if (str[i] === '(') {
                        // Encontrar o par√™ntese de fechamento
                        let depth = 1;
                        let j = i + 1;
                        while (j < str.length && depth > 0) {
                            if (str[j] === '(') depth++;
                            if (str[j] === ')') depth--;
                            j++;
                        }
                        // j agora aponta para depois do ')'
                        const groupContent = str.substring(i + 1, j - 1);
                        
                        // Verificar se h√° n√∫mero ap√≥s o par√™ntese
                        let numStr = '';
                        while (j < str.length && /\d/.test(str[j])) {
                            numStr += str[j];
                            j++;
                        }
                        const groupMultiplier = numStr ? parseInt(numStr) : 1;
                        
                        parseGroup(groupContent, multiplier * groupMultiplier);
                        i = j;
                    } else if (/[A-Z]/.test(str[i])) {
                        // Elemento
                        let element = str[i];
                        i++;
                        
                        // Verificar se h√° letra min√∫scula (s√≠mbolo de 2 letras)
                        while (i < str.length && /[a-z]/.test(str[i])) {
                            element += str[i];
                            i++;
                        }
                        
                        // Verificar n√∫mero
                        let numStr = '';
                        while (i < str.length && /\d/.test(str[i])) {
                            numStr += str[i];
                            i++;
                        }
                        const count = numStr ? parseInt(numStr) : 1;
                        
                        if (elementos[element]) {
                            elementos[element] += count * multiplier;
                        } else {
                            elementos[element] = count * multiplier;
                        }
                    } else {
                        i++;
                    }
                }
            }
            
            parseGroup(formula);
            return elementos;
        }

        // Calcular Massa Molar
        function calcMassaMolar() {
            const formula = document.getElementById('mm-formula').value.trim();
            
            if (!formula) {
                showResult('mm-result', '‚ùå Digite uma f√≥rmula qu√≠mica!', false);
                hideDesenvolvimento('mm');
                return;
            }
            
            try {
                const elementos = parseFormula(formula);
                const elementosKeys = Object.keys(elementos);
                
                if (elementosKeys.length === 0) {
                    showResult('mm-result', '‚ùå F√≥rmula inv√°lida!', false);
                    hideDesenvolvimento('mm');
                    return;
                }
                
                let massaTotal = 0;
                let devSteps = [];
                
                // Passo 1: Identificar a f√≥rmula
                devSteps.push({
                    titulo: 'Identificar a f√≥rmula',
                    formula: `F√≥rmula: ${formula}`,
                    descricao: 'Massa molar √© a soma das massas at√¥micas de todos os √°tomos'
                });
                
                // Passo 2: Identificar os elementos
                let elementosTexto = elementosKeys.map(elem => {
                    const qtd = elementos[elem];
                    return qtd > 1 ? `${elem}: ${qtd} √°tomos` : `${elem}: ${qtd} √°tomo`;
                }).join(' | ');
                
                devSteps.push({
                    titulo: 'Identificar os elementos',
                    formula: elementosTexto,
                    descricao: 'Contagem de √°tomos de cada elemento na f√≥rmula'
                });
                
                // Passo 3: Calcular contribui√ß√£o de cada elemento
                let calculosTexto = '';
                for (const elem of elementosKeys) {
                    if (!elementosMassas[elem]) {
                        showResult('mm-result', `‚ùå Elemento "${elem}" n√£o encontrado na tabela!`, false);
                        hideDesenvolvimento('mm');
                        return;
                    }
                    
                    const info = elementosMassas[elem];
                    const quantidade = elementos[elem];
                    const massaElemento = info.massa * quantidade;
                    massaTotal += massaElemento;
                    
                    calculosTexto += `${elem}: ${info.massa} √ó ${quantidade} = ${massaElemento.toFixed(3)} g/mol<br>`;
                }
                
                devSteps.push({
                    titulo: 'Calcular cada contribui√ß√£o',
                    formula: calculosTexto.replace(/<br>$/, ''),
                    descricao: 'Massa at√¥mica √ó quantidade de √°tomos'
                });
                
                // Passo 4: Somar tudo
                let somaFormula = elementosKeys.map(elem => {
                    const info = elementosMassas[elem];
                    const quantidade = elementos[elem];
                    return (info.massa * quantidade).toFixed(3);
                }).join(' + ');
                
                devSteps.push({
                    titulo: 'Somar todas as contribui√ß√µes',
                    formula: `MM = ${somaFormula}`,
                    descricao: 'Somando as massas de todos os elementos'
                });
                
                // Passo 5: Resultado final
                devSteps.push({
                    titulo: 'Resultado Final',
                    formula: `MM(${formula}) = ${massaTotal.toFixed(3)} g/mol`,
                    descricao: 'Massa molar do composto'
                });
                
                showResult('mm-result', `‚úì Massa Molar de ${formula} = ${massaTotal.toFixed(3)} g/mol`);
                saveDesenvolvimento('mm', { steps: devSteps });
                
            } catch (e) {
                showResult('mm-result', '‚ùå Erro ao processar a f√≥rmula. Verifique a sintaxe!', false);
                hideDesenvolvimento('mm');
            }
        }

        function clearMassaMolar() {
            document.getElementById('mm-formula').value = '';
            document.getElementById('mm-result').classList.remove('show');
            hideDesenvolvimento('mm');
        }

        // Mostrar lista de elementos dispon√≠veis
        function mostrarElementos() {
            const lista = document.getElementById('elementos-lista');
            if (lista) {
                const elementosArray = Object.entries(elementosMassas).map(([simbolo, info]) => 
                    `<span style="display: inline-block; margin: 2px 5px; padding: 2px 6px; background: #e8f5e9; border-radius: 4px;"><strong>${simbolo}</strong>: ${info.massa}</span>`
                );
                lista.innerHTML = elementosArray.join('');
            }
        }

        // Inicializa√ß√£o
        updatePorcentagemLabels();
        mostrarElementos();
    </script>
</body>
</html>
