<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Qu√≠mica de Solu√ß√µes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab {
            flex: 1;
            min-width: 120px;
            padding: 15px 10px;
            background: #f5f5f5;
            border: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .content {
            padding: 25px;
        }

        .calc-section {
            display: none;
        }

        .calc-section.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border 0.3s, background 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        input.calculated {
            background: #e8f5e9;
            border-color: #4caf50;
        }

        .input-with-unit {
            display: flex;
            gap: 10px;
        }

        .input-with-unit input {
            flex: 2;
        }

        .input-with-unit select {
            flex: 1;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 10px;
        }

        button:active {
            transform: scale(0.98);
        }

        button:hover {
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button.clear-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%);
            margin-top: 10px;
        }

        .result {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 10px;
            color: white;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            display: none;
            animation: slideIn 0.3s;
        }

        .result.success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .result.error {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result.show {
            display: block;
        }

        .formula {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .formula-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 8px;
        }

        .formula-text {
            font-family: 'Courier New', monospace;
            color: #555;
            font-size: 14px;
        }

        .info {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 13px;
            color: #1976d2;
        }

        .info.tip {
            background: #fff3e0;
            color: #e65100;
            border-left: 4px solid #ff9800;
        }

        .calculation-steps {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 13px;
            color: #555;
            line-height: 1.8;
        }

        .calculation-steps .step {
            margin: 5px 0;
            padding-left: 10px;
            border-left: 2px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß™ Calculadora Qu√≠mica</h1>
            <p>C√°lculos de Solu√ß√µes e Concentra√ß√µes</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('conc-comum')">C (g/L)</button>
            <button class="tab" onclick="showTab('molar')">Molar</button>
            <button class="tab" onclick="showTab('porcentagem')">%</button>
            <button class="tab" onclick="showTab('densidade')">Densidade</button>
            <button class="tab" onclick="showTab('fracao')">Fra√ß√£o</button>
            <button class="tab" onclick="showTab('solubilidade')">Solubilidade</button>
            <button class="tab" onclick="showTab('diluicao')">Dilui√ß√£o</button>
            <button class="tab" onclick="showTab('massa-molar')">Massa Molar</button>
        </div>

        <div class="content">
            <!-- Concentra√ß√£o Comum -->
            <div class="calc-section active" id="conc-comum">
                <div class="formula">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">C = m‚ÇÅ / V (g/L)</div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Concentra√ß√£o (C)</label>
                    <div class="input-with-unit">
                        <input type="number" id="cc-conc" step="any" placeholder="Deixe vazio para calcular">
                        <select id="cc-conc-unit">
                            <option value="1">g/L</option>
                            <option value="0.001">mg/L</option>
                            <option value="1000">kg/L</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa do soluto (m‚ÇÅ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="cc-massa" step="any" placeholder="Deixe vazio para calcular">
                        <select id="cc-massa-unit">
                            <option value="1">g</option>
                            <option value="0.001">mg</option>
                            <option value="1000">kg</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume da solu√ß√£o (V)</label>
                    <div class="input-with-unit">
                        <input type="number" id="cc-volume" step="any" placeholder="Deixe vazio para calcular">
                        <select id="cc-volume-unit">
                            <option value="1">L</option>
                            <option value="0.001">mL</option>
                            <option value="0.000001">ŒºL</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcConcComum()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('cc')">Limpar</button>
                <div class="result" id="cc-result"></div>
                <div class="calculation-steps" id="cc-steps" style="display:none;"></div>
            </div>

            <!-- Concentra√ß√£o Molar -->
            <div class="calc-section" id="molar">
                <div class="formula">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">M = n / V = m / (MM √ó V) (mol/L)</div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Molaridade (M)</label>
                    <div class="input-with-unit">
                        <input type="number" id="m-molar" step="any" placeholder="Deixe vazio para calcular">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px;">mol/L</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa do soluto (m)</label>
                    <div class="input-with-unit">
                        <input type="number" id="m-massa" step="any" placeholder="Deixe vazio para calcular">
                        <select id="m-massa-unit">
                            <option value="1">g</option>
                            <option value="0.001">mg</option>
                            <option value="1000">kg</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa Molar (MM) - Obrigat√≥rio</label>
                    <div class="input-with-unit">
                        <input type="number" id="m-mm" step="any" placeholder="g/mol">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px;">g/mol</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume da solu√ß√£o (V)</label>
                    <div class="input-with-unit">
                        <input type="number" id="m-volume" step="any" placeholder="Deixe vazio para calcular">
                        <select id="m-volume-unit">
                            <option value="1">L</option>
                            <option value="0.001">mL</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcMolar()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('m')">Limpar</button>
                <div class="result" id="m-result"></div>
                <div class="calculation-steps" id="m-steps" style="display:none;"></div>
            </div>

            <!-- Porcentagem -->
            <div class="calc-section" id="porcentagem">
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Tipo de Concentra√ß√£o</label>
                    <select id="p-tipo" onchange="updatePorcentagemLabels()">
                        <option value="mm">Massa/Massa (m/m %)</option>
                        <option value="vv">Volume/Volume (v/v %)</option>
                        <option value="mv">Massa/Volume (m/v %)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Porcentagem (%)</label>
                    <div class="input-with-unit">
                        <input type="number" id="p-perc" step="any" placeholder="Deixe vazio para calcular">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px;">%</span>
                    </div>
                </div>
                <div id="p-inputs">
                    <div class="input-group">
                        <label id="p-label1">Massa do soluto</label>
                        <div class="input-with-unit">
                            <input type="number" id="p-val1" step="any" placeholder="Deixe vazio para calcular">
                            <select id="p-unit1">
                                <option value="1">g</option>
                                <option value="0.001">mg</option>
                                <option value="1000">kg</option>
                            </select>
                        </div>
                    </div>
                    <div class="input-group">
                        <label id="p-label2">Massa da solu√ß√£o</label>
                        <div class="input-with-unit">
                            <input type="number" id="p-val2" step="any" placeholder="Deixe vazio para calcular">
                            <select id="p-unit2">
                                <option value="1">g</option>
                                <option value="0.001">mg</option>
                                <option value="1000">kg</option>
                            </select>
                        </div>
                    </div>
                </div>
                <button onclick="calcPorcentagem()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('p')">Limpar</button>
                <div class="result" id="p-result"></div>
                <div class="calculation-steps" id="p-steps" style="display:none;"></div>
            </div>

            <!-- Densidade -->
            <div class="calc-section" id="densidade">
                <div class="formula">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">d = m / V</div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Densidade (d)</label>
                    <div class="input-with-unit">
                        <input type="number" id="d-dens" step="any" placeholder="Deixe vazio para calcular">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px;">g/mL</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa (m)</label>
                    <div class="input-with-unit">
                        <input type="number" id="d-massa" step="any" placeholder="Deixe vazio para calcular">
                        <select id="d-massa-unit">
                            <option value="1">g</option>
                            <option value="0.001">mg</option>
                            <option value="1000">kg</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume (V)</label>
                    <div class="input-with-unit">
                        <input type="number" id="d-volume" step="any" placeholder="Deixe vazio para calcular">
                        <select id="d-volume-unit">
                            <option value="1">mL</option>
                            <option value="1000">L</option>
                            <option value="0.001">ŒºL</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcDensidade()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('d')">Limpar</button>
                <div class="result" id="d-result"></div>
                <div class="calculation-steps" id="d-steps" style="display:none;"></div>
            </div>

            <!-- Fra√ß√£o Molar -->
            <div class="calc-section" id="fracao">
                <div class="formula">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">X‚ÇÅ = n‚ÇÅ / (n‚ÇÅ + n‚ÇÇ)</div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Fra√ß√£o Molar do soluto (X‚ÇÅ)</label>
                    <input type="number" id="f-x" step="any" placeholder="Deixe vazio para calcular (0 a 1)">
                </div>
                <div class="input-group">
                    <label>N√∫mero de mols do soluto (n‚ÇÅ)</label>
                    <input type="number" id="f-n1" step="any" placeholder="Deixe vazio para calcular">
                </div>
                <div class="input-group">
                    <label>N√∫mero de mols do solvente (n‚ÇÇ)</label>
                    <input type="number" id="f-n2" step="any" placeholder="Deixe vazio para calcular">
                </div>
                <button onclick="calcFracaoMolar()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('f')">Limpar</button>
                <div class="result" id="f-result"></div>
                <div class="calculation-steps" id="f-steps" style="display:none;"></div>
            </div>

            <!-- Coeficiente de Solubilidade -->
            <div class="calc-section" id="solubilidade">
                <div class="formula">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">Cs = (massa soluto / massa solvente) √ó 100</div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Coeficiente de Solubilidade (Cs)</label>
                    <div class="input-with-unit">
                        <input type="number" id="s-cs" step="any" placeholder="Deixe vazio para calcular">
                        <span style="padding: 12px; background: #f0f0f0; border-radius: 10px; font-size: 12px;">g/100g</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa de soluto dissolvida</label>
                    <div class="input-with-unit">
                        <input type="number" id="s-soluto" step="any" placeholder="Deixe vazio para calcular">
                        <select id="s-soluto-unit">
                            <option value="1">g</option>
                            <option value="0.001">mg</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Massa do solvente</label>
                    <div class="input-with-unit">
                        <input type="number" id="s-solvente" step="any" placeholder="Deixe vazio para calcular">
                        <select id="s-solvente-unit">
                            <option value="1">g</option>
                            <option value="1000">kg</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcSolubilidade()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('s')">Limpar</button>
                <div class="result" id="s-result"></div>
                <div class="calculation-steps" id="s-steps" style="display:none;"></div>
            </div>

            <!-- Dilui√ß√£o -->
            <div class="calc-section" id="diluicao">
                <div class="formula">
                    <div class="formula-title">F√≥rmula</div>
                    <div class="formula-text">C‚ÇÅ √ó V‚ÇÅ = C‚ÇÇ √ó V‚ÇÇ</div>
                </div>
                <div class="info tip">
                    üí° Deixe EM BRANCO o valor que deseja calcular!
                </div>
                <div class="input-group">
                    <label>Concentra√ß√£o inicial (C‚ÇÅ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="dil-c1" step="any" placeholder="Deixe vazio para calcular">
                        <select id="dil-c1-unit">
                            <option value="1">mol/L</option>
                            <option value="1">g/L</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume inicial (V‚ÇÅ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="dil-v1" step="any" placeholder="Deixe vazio para calcular">
                        <select id="dil-v1-unit">
                            <option value="1">L</option>
                            <option value="0.001">mL</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Concentra√ß√£o final (C‚ÇÇ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="dil-c2" step="any" placeholder="Deixe vazio para calcular">
                        <select id="dil-c2-unit">
                            <option value="1">mol/L</option>
                            <option value="1">g/L</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Volume final (V‚ÇÇ)</label>
                    <div class="input-with-unit">
                        <input type="number" id="dil-v2" step="any" placeholder="Deixe vazio para calcular">
                        <select id="dil-v2-unit">
                            <option value="1">L</option>
                            <option value="0.001">mL</option>
                        </select>
                    </div>
                </div>
                <button onclick="calcDiluicao()">Calcular</button>
                <button class="clear-btn" onclick="clearFields('dil')">Limpar</button>
                <div class="result" id="dil-result"></div>
                <div class="calculation-steps" id="dil-steps" style="display:none;"></div>
            </div>

            <!-- Massa Molar -->
            <div class="calc-section" id="massa-molar">
                <div class="formula">
                    <div class="formula-title">Calculadora de Massa Molar</div>
                    <div class="formula-text">MM = Œ£ (massa at√¥mica √ó quantidade)</div>
                </div>
                <div class="info">
                    ‚öóÔ∏è Digite a f√≥rmula qu√≠mica do composto (ex: H2O, NaCl, H2SO4, Ca(OH)2)
                </div>
                <div class="input-group">
                    <label>F√≥rmula Qu√≠mica</label>
                    <input type="text" id="mm-formula" placeholder="Ex: H2O, NaCl, H2SO4, Ca(OH)2" style="text-transform: none;" oninput="this.value = this.value.replace(/[^A-Za-z0-9()]/g, '')">
                </div>
                <button onclick="calcMassaMolar()">Calcular Massa Molar</button>
                <button class="clear-btn" onclick="clearMassaMolar()">Limpar</button>
                <div class="result" id="mm-result"></div>
                <div class="calculation-steps" id="mm-steps" style="display:none;"></div>
                
                <div style="margin-top: 20px; padding: 15px; background: #f9f9f9; border-radius: 10px;">
                    <div style="font-weight: 600; color: #667eea; margin-bottom: 10px;">üìã Elementos Dispon√≠veis:</div>
                    <div id="elementos-lista" style="font-size: 12px; color: #555; line-height: 1.8; max-height: 200px; overflow-y: auto;"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabId) {
            const tabs = document.querySelectorAll('.tab');
            const sections = document.querySelectorAll('.calc-section');
            
            tabs.forEach(t => t.classList.remove('active'));
            sections.forEach(s => s.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        function showResult(elementId, message, isSuccess = true) {
            const el = document.getElementById(elementId);
            el.textContent = message;
            el.className = 'result show ' + (isSuccess ? 'success' : 'error');
        }

        function showSteps(elementId, steps) {
            const el = document.getElementById(elementId);
            el.innerHTML = '<strong>üìù Passo a passo:</strong><br>' + 
                steps.map(s => `<div class="step">${s}</div>`).join('');
            el.style.display = 'block';
        }

        function hideSteps(elementId) {
            document.getElementById(elementId).style.display = 'none';
        }

        function clearFields(prefix) {
            const inputs = document.querySelectorAll(`[id^="${prefix}-"]`);
            inputs.forEach(input => {
                if (input.tagName === 'INPUT') {
                    input.value = '';
                    input.classList.remove('calculated');
                }
            });
            const result = document.getElementById(`${prefix}-result`);
            if (result) {
                result.classList.remove('show');
            }
            const steps = document.getElementById(`${prefix}-steps`);
            if (steps) {
                steps.style.display = 'none';
            }
        }

        function getValue(id) {
            const val = document.getElementById(id).value;
            return val === '' ? null : parseFloat(val);
        }

        function getValueWithUnit(id, unitId) {
            const val = getValue(id);
            if (val === null) return null;
            const unit = parseFloat(document.getElementById(unitId).value);
            return val * unit;
        }

        function setCalculated(id, value) {
            const input = document.getElementById(id);
            input.value = formatNumber(value);
            input.classList.add('calculated');
        }

        // Fun√ß√£o para definir valor calculado considerando a unidade selecionada
        function setCalculatedWithUnit(id, valueInBase, unitId) {
            const input = document.getElementById(id);
            const unitFactor = parseFloat(document.getElementById(unitId).value);
            const valueInUnit = valueInBase / unitFactor;
            input.value = formatNumber(valueInUnit);
            input.classList.add('calculated');
            return valueInUnit;
        }

        // Fun√ß√£o para obter o texto da unidade selecionada
        function getUnitLabel(unitId) {
            const select = document.getElementById(unitId);
            return select.options[select.selectedIndex].text;
        }

        // Fun√ß√£o para formatar n√∫meros de forma leg√≠vel
        function formatNumber(value) {
            if (value === 0) return '0';
            const abs = Math.abs(value);
            if (abs >= 0.001 && abs < 1000000) {
                // Para n√∫meros normais, usar at√© 6 casas decimais significativas
                const formatted = parseFloat(value.toPrecision(6));
                return formatted.toString();
            } else {
                // Para n√∫meros muito grandes ou pequenos, usar nota√ß√£o cient√≠fica
                return value.toExponential(4);
            }
        }

        // Concentra√ß√£o Comum: C = m / V
        function calcConcComum() {
            const C = getValueWithUnit('cc-conc', 'cc-conc-unit');
            const m = getValueWithUnit('cc-massa', 'cc-massa-unit');
            const V = getValueWithUnit('cc-volume', 'cc-volume-unit');

            const nullCount = [C, m, V].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('cc-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideSteps('cc-steps');
                return;
            }
            if (nullCount > 1) {
                showResult('cc-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideSteps('cc-steps');
                return;
            }

            let steps = [];
            
            if (C === null) {
                // C = m / V
                if (V === 0) {
                    showResult('cc-result', '‚ùå Volume n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = m / V; // resultado em g/L
                const resultDisplay = setCalculatedWithUnit('cc-conc', resultBase, 'cc-conc-unit');
                const unitLabel = getUnitLabel('cc-conc-unit');
                steps = [
                    `F√≥rmula: C = m / V`,
                    `C = ${formatNumber(m)} g / ${formatNumber(V)} L`,
                    `C = ${formatNumber(resultBase)} g/L = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('cc-result', `‚úì Concentra√ß√£o = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else if (m === null) {
                // m = C √ó V
                const resultBase = C * V; // resultado em g
                const resultDisplay = setCalculatedWithUnit('cc-massa', resultBase, 'cc-massa-unit');
                const unitLabel = getUnitLabel('cc-massa-unit');
                steps = [
                    `F√≥rmula: m = C √ó V`,
                    `m = ${formatNumber(C)} g/L √ó ${formatNumber(V)} L`,
                    `m = ${formatNumber(resultBase)} g = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('cc-result', `‚úì Massa = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                // V = m / C
                if (C === 0) {
                    showResult('cc-result', '‚ùå Concentra√ß√£o n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = m / C; // resultado em L
                const resultDisplay = setCalculatedWithUnit('cc-volume', resultBase, 'cc-volume-unit');
                const unitLabel = getUnitLabel('cc-volume-unit');
                steps = [
                    `F√≥rmula: V = m / C`,
                    `V = ${formatNumber(m)} g / ${formatNumber(C)} g/L`,
                    `V = ${formatNumber(resultBase)} L = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('cc-result', `‚úì Volume = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            showSteps('cc-steps', steps);
        }

        // Molar: M = m / (MM √ó V)
        function calcMolar() {
            const M = getValue('m-molar');
            const m = getValueWithUnit('m-massa', 'm-massa-unit');
            const MM = getValue('m-mm');
            const V = getValueWithUnit('m-volume', 'm-volume-unit');

            if (!MM || MM === 0) {
                showResult('m-result', '‚ùå Massa Molar √© obrigat√≥ria!', false);
                hideSteps('m-steps');
                return;
            }

            const nullCount = [M, m, V].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('m-result', '‚ùå Deixe UM campo em branco (exceto MM)!', false);
                hideSteps('m-steps');
                return;
            }
            if (nullCount > 1) {
                showResult('m-result', '‚ùå Preencha pelo menos 2 valores (al√©m de MM)!', false);
                hideSteps('m-steps');
                return;
            }

            let steps = [];

            if (M === null) {
                // M = m / (MM √ó V)
                if (V === 0) {
                    showResult('m-result', '‚ùå Volume n√£o pode ser zero!', false);
                    return;
                }
                const result = m / (MM * V);
                steps = [
                    `F√≥rmula: M = m / (MM √ó V)`,
                    `M = ${formatNumber(m)} g / (${formatNumber(MM)} g/mol √ó ${formatNumber(V)} L)`,
                    `M = ${formatNumber(result)} mol/L`
                ];
                setCalculated('m-molar', result);
                showResult('m-result', `‚úì Molaridade = ${formatNumber(result)} mol/L`);
            } else if (m === null) {
                // m = M √ó MM √ó V
                const resultBase = M * MM * V; // resultado em g
                const resultDisplay = setCalculatedWithUnit('m-massa', resultBase, 'm-massa-unit');
                const unitLabel = getUnitLabel('m-massa-unit');
                steps = [
                    `F√≥rmula: m = M √ó MM √ó V`,
                    `m = ${formatNumber(M)} mol/L √ó ${formatNumber(MM)} g/mol √ó ${formatNumber(V)} L`,
                    `m = ${formatNumber(resultBase)} g = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('m-result', `‚úì Massa = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                // V = m / (M √ó MM)
                if (M === 0) {
                    showResult('m-result', '‚ùå Molaridade n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = m / (M * MM); // resultado em L
                const resultDisplay = setCalculatedWithUnit('m-volume', resultBase, 'm-volume-unit');
                const unitLabel = getUnitLabel('m-volume-unit');
                steps = [
                    `F√≥rmula: V = m / (M √ó MM)`,
                    `V = ${formatNumber(m)} g / (${formatNumber(M)} mol/L √ó ${formatNumber(MM)} g/mol)`,
                    `V = ${formatNumber(resultBase)} L = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('m-result', `‚úì Volume = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            showSteps('m-steps', steps);
        }

        function updatePorcentagemLabels() {
            const tipo = document.getElementById('p-tipo').value;
            const label1 = document.getElementById('p-label1');
            const label2 = document.getElementById('p-label2');
            const unit1 = document.getElementById('p-unit1');
            const unit2 = document.getElementById('p-unit2');
            
            unit1.innerHTML = '';
            unit2.innerHTML = '';
            
            if (tipo === 'mm') {
                label1.textContent = 'Massa do soluto';
                label2.textContent = 'Massa da solu√ß√£o';
                unit1.innerHTML = '<option value="1">g</option><option value="0.001">mg</option><option value="1000">kg</option>';
                unit2.innerHTML = '<option value="1">g</option><option value="0.001">mg</option><option value="1000">kg</option>';
            } else if (tipo === 'vv') {
                label1.textContent = 'Volume do soluto';
                label2.textContent = 'Volume da solu√ß√£o';
                unit1.innerHTML = '<option value="1">mL</option><option value="1000">L</option>';
                unit2.innerHTML = '<option value="1">mL</option><option value="1000">L</option>';
            } else {
                label1.textContent = 'Massa do soluto';
                label2.textContent = 'Volume da solu√ß√£o';
                unit1.innerHTML = '<option value="1">g</option><option value="0.001">mg</option><option value="1000">kg</option>';
                unit2.innerHTML = '<option value="1">mL</option><option value="1000">L</option>';
            }
        }

        // Porcentagem: % = (parte / total) √ó 100
        function calcPorcentagem() {
            const perc = getValue('p-perc');
            const val1 = getValueWithUnit('p-val1', 'p-unit1');
            const val2 = getValueWithUnit('p-val2', 'p-unit2');
            const tipo = document.getElementById('p-tipo').value;

            const nullCount = [perc, val1, val2].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('p-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideSteps('p-steps');
                return;
            }
            if (nullCount > 1) {
                showResult('p-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideSteps('p-steps');
                return;
            }

            let tipoTexto = tipo === 'mm' ? 'm/m' : (tipo === 'vv' ? 'v/v' : 'm/v');
            // Unidades base para os c√°lculos
            let unidadeBase1 = tipo === 'vv' ? 'mL' : 'g';
            let unidadeBase2 = tipo === 'mm' ? 'g' : 'mL';
            
            let steps = [];

            if (perc === null) {
                // % = (parte / total) √ó 100
                if (val2 === 0) {
                    showResult('p-result', '‚ùå O total n√£o pode ser zero!', false);
                    return;
                }
                const result = (val1 / val2) * 100;
                steps = [
                    `F√≥rmula: % = (parte / total) √ó 100`,
                    `% = (${formatNumber(val1)} ${unidadeBase1} / ${formatNumber(val2)} ${unidadeBase2}) √ó 100`,
                    `% = ${formatNumber(result)} %`
                ];
                setCalculated('p-perc', result);
                showResult('p-result', `‚úì ${tipoTexto} = ${formatNumber(result)} %`);
            } else if (val1 === null) {
                // parte = (% √ó total) / 100
                const resultBase = (perc * val2) / 100; // resultado na unidade base
                const resultDisplay = setCalculatedWithUnit('p-val1', resultBase, 'p-unit1');
                const unitLabel = getUnitLabel('p-unit1');
                steps = [
                    `F√≥rmula: parte = (% √ó total) / 100`,
                    `parte = (${formatNumber(perc)} √ó ${formatNumber(val2)} ${unidadeBase2}) / 100`,
                    `parte = ${formatNumber(resultBase)} ${unidadeBase1} = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('p-result', `‚úì Parte = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                // total = (parte √ó 100) / %
                if (perc === 0) {
                    showResult('p-result', '‚ùå Porcentagem n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = (val1 * 100) / perc; // resultado na unidade base
                const resultDisplay = setCalculatedWithUnit('p-val2', resultBase, 'p-unit2');
                const unitLabel = getUnitLabel('p-unit2');
                steps = [
                    `F√≥rmula: total = (parte √ó 100) / %`,
                    `total = (${formatNumber(val1)} ${unidadeBase1} √ó 100) / ${formatNumber(perc)}`,
                    `total = ${formatNumber(resultBase)} ${unidadeBase2} = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('p-result', `‚úì Total = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            showSteps('p-steps', steps);
        }

        // Densidade: d = m / V
        function calcDensidade() {
            const d = getValue('d-dens');
            const m = getValueWithUnit('d-massa', 'd-massa-unit');
            const V = getValueWithUnit('d-volume', 'd-volume-unit');

            const nullCount = [d, m, V].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('d-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideSteps('d-steps');
                return;
            }
            if (nullCount > 1) {
                showResult('d-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideSteps('d-steps');
                return;
            }

            let steps = [];

            if (d === null) {
                // d = m / V (resultado em g/mL)
                if (V === 0) {
                    showResult('d-result', '‚ùå Volume n√£o pode ser zero!', false);
                    return;
                }
                const result = m / V;
                steps = [
                    `F√≥rmula: d = m / V`,
                    `d = ${formatNumber(m)} g / ${formatNumber(V)} mL`,
                    `d = ${formatNumber(result)} g/mL`
                ];
                setCalculated('d-dens', result);
                showResult('d-result', `‚úì Densidade = ${formatNumber(result)} g/mL`);
            } else if (m === null) {
                // m = d √ó V (resultado em g)
                const resultBase = d * V;
                const resultDisplay = setCalculatedWithUnit('d-massa', resultBase, 'd-massa-unit');
                const unitLabel = getUnitLabel('d-massa-unit');
                steps = [
                    `F√≥rmula: m = d √ó V`,
                    `m = ${formatNumber(d)} g/mL √ó ${formatNumber(V)} mL`,
                    `m = ${formatNumber(resultBase)} g = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('d-result', `‚úì Massa = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                // V = m / d (resultado em mL)
                if (d === 0) {
                    showResult('d-result', '‚ùå Densidade n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = m / d;
                const resultDisplay = setCalculatedWithUnit('d-volume', resultBase, 'd-volume-unit');
                const unitLabel = getUnitLabel('d-volume-unit');
                steps = [
                    `F√≥rmula: V = m / d`,
                    `V = ${formatNumber(m)} g / ${formatNumber(d)} g/mL`,
                    `V = ${formatNumber(resultBase)} mL = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('d-result', `‚úì Volume = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            showSteps('d-steps', steps);
        }

        // Fra√ß√£o Molar: X‚ÇÅ = n‚ÇÅ / (n‚ÇÅ + n‚ÇÇ)
        function calcFracaoMolar() {
            const X = getValue('f-x');
            const n1 = getValue('f-n1');
            const n2 = getValue('f-n2');

            const nullCount = [X, n1, n2].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('f-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideSteps('f-steps');
                return;
            }
            if (nullCount > 1) {
                showResult('f-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideSteps('f-steps');
                return;
            }

            let steps = [];

            if (X === null) {
                // X = n1 / (n1 + n2)
                if (n1 + n2 === 0) {
                    showResult('f-result', '‚ùå Soma dos mols n√£o pode ser zero!', false);
                    return;
                }
                const result = n1 / (n1 + n2);
                const x2 = 1 - result;
                steps = [
                    `F√≥rmula: X‚ÇÅ = n‚ÇÅ / (n‚ÇÅ + n‚ÇÇ)`,
                    `X‚ÇÅ = ${formatNumber(n1)} / (${formatNumber(n1)} + ${formatNumber(n2)})`,
                    `X‚ÇÅ = ${formatNumber(result)}`,
                    `X‚ÇÇ = 1 - X‚ÇÅ = ${formatNumber(x2)}`
                ];
                setCalculated('f-x', result);
                showResult('f-result', `‚úì X‚ÇÅ = ${formatNumber(result)} | X‚ÇÇ = ${formatNumber(x2)}`);
            } else if (n1 === null) {
                // n1 = (X √ó n2) / (1 - X)
                if (X >= 1) {
                    showResult('f-result', '‚ùå Fra√ß√£o molar deve ser menor que 1!', false);
                    return;
                }
                const result = (X * n2) / (1 - X);
                steps = [
                    `F√≥rmula: n‚ÇÅ = (X‚ÇÅ √ó n‚ÇÇ) / (1 - X‚ÇÅ)`,
                    `n‚ÇÅ = (${formatNumber(X)} √ó ${formatNumber(n2)}) / (1 - ${formatNumber(X)})`,
                    `n‚ÇÅ = ${formatNumber(result)} mol`
                ];
                setCalculated('f-n1', result);
                showResult('f-result', `‚úì n‚ÇÅ = ${formatNumber(result)} mol`);
            } else {
                // n2 = n1 √ó (1 - X) / X
                if (X === 0) {
                    showResult('f-result', '‚ùå Fra√ß√£o molar n√£o pode ser zero!', false);
                    return;
                }
                const result = n1 * (1 - X) / X;
                steps = [
                    `F√≥rmula: n‚ÇÇ = n‚ÇÅ √ó (1 - X‚ÇÅ) / X‚ÇÅ`,
                    `n‚ÇÇ = ${formatNumber(n1)} √ó (1 - ${formatNumber(X)}) / ${formatNumber(X)}`,
                    `n‚ÇÇ = ${formatNumber(result)} mol`
                ];
                setCalculated('f-n2', result);
                showResult('f-result', `‚úì n‚ÇÇ = ${formatNumber(result)} mol`);
            }
            showSteps('f-steps', steps);
        }

        // Solubilidade: Cs = (soluto / solvente) √ó 100
        function calcSolubilidade() {
            const Cs = getValue('s-cs');
            const soluto = getValueWithUnit('s-soluto', 's-soluto-unit');
            const solvente = getValueWithUnit('s-solvente', 's-solvente-unit');

            const nullCount = [Cs, soluto, solvente].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('s-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideSteps('s-steps');
                return;
            }
            if (nullCount > 1) {
                showResult('s-result', '‚ùå Preencha pelo menos 2 valores!', false);
                hideSteps('s-steps');
                return;
            }

            let steps = [];

            if (Cs === null) {
                // Cs = (soluto / solvente) √ó 100
                if (solvente === 0) {
                    showResult('s-result', '‚ùå Massa do solvente n√£o pode ser zero!', false);
                    return;
                }
                const result = (soluto / solvente) * 100;
                steps = [
                    `F√≥rmula: Cs = (soluto / solvente) √ó 100`,
                    `Cs = (${formatNumber(soluto)} g / ${formatNumber(solvente)} g) √ó 100`,
                    `Cs = ${formatNumber(result)} g/100g`
                ];
                setCalculated('s-cs', result);
                showResult('s-result', `‚úì Cs = ${formatNumber(result)} g/100g de solvente`);
            } else if (soluto === null) {
                // soluto = (Cs √ó solvente) / 100 (resultado em g)
                const resultBase = (Cs * solvente) / 100;
                const resultDisplay = setCalculatedWithUnit('s-soluto', resultBase, 's-soluto-unit');
                const unitLabel = getUnitLabel('s-soluto-unit');
                steps = [
                    `F√≥rmula: soluto = (Cs √ó solvente) / 100`,
                    `soluto = (${formatNumber(Cs)} √ó ${formatNumber(solvente)} g) / 100`,
                    `soluto = ${formatNumber(resultBase)} g = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('s-result', `‚úì Massa de soluto = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                // solvente = (soluto √ó 100) / Cs (resultado em g)
                if (Cs === 0) {
                    showResult('s-result', '‚ùå Coeficiente n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = (soluto * 100) / Cs;
                const resultDisplay = setCalculatedWithUnit('s-solvente', resultBase, 's-solvente-unit');
                const unitLabel = getUnitLabel('s-solvente-unit');
                steps = [
                    `F√≥rmula: solvente = (soluto √ó 100) / Cs`,
                    `solvente = (${formatNumber(soluto)} g √ó 100) / ${formatNumber(Cs)}`,
                    `solvente = ${formatNumber(resultBase)} g = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('s-result', `‚úì Massa de solvente = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            showSteps('s-steps', steps);
        }

        // Dilui√ß√£o: C‚ÇÅV‚ÇÅ = C‚ÇÇV‚ÇÇ
        function calcDiluicao() {
            const C1 = getValueWithUnit('dil-c1', 'dil-c1-unit');
            const V1 = getValueWithUnit('dil-v1', 'dil-v1-unit');
            const C2 = getValueWithUnit('dil-c2', 'dil-c2-unit');
            const V2 = getValueWithUnit('dil-v2', 'dil-v2-unit');

            const nullCount = [C1, V1, C2, V2].filter(x => x === null).length;
            
            if (nullCount === 0) {
                showResult('dil-result', '‚ùå Deixe UM campo em branco para calcular!', false);
                hideSteps('dil-steps');
                return;
            }
            if (nullCount > 1) {
                showResult('dil-result', '‚ùå Preencha pelo menos 3 valores!', false);
                hideSteps('dil-steps');
                return;
            }

            let steps = [];

            if (C1 === null) {
                // C1 = (C2 √ó V2) / V1 (concentra√ß√£o, sem convers√£o de unidade espec√≠fica)
                if (V1 === 0) {
                    showResult('dil-result', '‚ùå V‚ÇÅ n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = (C2 * V2) / V1;
                const resultDisplay = setCalculatedWithUnit('dil-c1', resultBase, 'dil-c1-unit');
                const unitLabel = getUnitLabel('dil-c1-unit');
                steps = [
                    `F√≥rmula: C‚ÇÅ = (C‚ÇÇ √ó V‚ÇÇ) / V‚ÇÅ`,
                    `C‚ÇÅ = (${formatNumber(C2)} √ó ${formatNumber(V2)} L) / ${formatNumber(V1)} L`,
                    `C‚ÇÅ = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('dil-result', `‚úì C‚ÇÅ = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else if (V1 === null) {
                // V1 = (C2 √ó V2) / C1 (resultado em L)
                if (C1 === 0) {
                    showResult('dil-result', '‚ùå C‚ÇÅ n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = (C2 * V2) / C1;
                const resultDisplay = setCalculatedWithUnit('dil-v1', resultBase, 'dil-v1-unit');
                const unitLabel = getUnitLabel('dil-v1-unit');
                steps = [
                    `F√≥rmula: V‚ÇÅ = (C‚ÇÇ √ó V‚ÇÇ) / C‚ÇÅ`,
                    `V‚ÇÅ = (${formatNumber(C2)} √ó ${formatNumber(V2)} L) / ${formatNumber(C1)}`,
                    `V‚ÇÅ = ${formatNumber(resultBase)} L = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('dil-result', `‚úì V‚ÇÅ = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else if (C2 === null) {
                // C2 = (C1 √ó V1) / V2 (concentra√ß√£o)
                if (V2 === 0) {
                    showResult('dil-result', '‚ùå V‚ÇÇ n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = (C1 * V1) / V2;
                const resultDisplay = setCalculatedWithUnit('dil-c2', resultBase, 'dil-c2-unit');
                const unitLabel = getUnitLabel('dil-c2-unit');
                steps = [
                    `F√≥rmula: C‚ÇÇ = (C‚ÇÅ √ó V‚ÇÅ) / V‚ÇÇ`,
                    `C‚ÇÇ = (${formatNumber(C1)} √ó ${formatNumber(V1)} L) / ${formatNumber(V2)} L`,
                    `C‚ÇÇ = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('dil-result', `‚úì C‚ÇÇ = ${formatNumber(resultDisplay)} ${unitLabel}`);
            } else {
                // V2 = (C1 √ó V1) / C2 (resultado em L)
                if (C2 === 0) {
                    showResult('dil-result', '‚ùå C‚ÇÇ n√£o pode ser zero!', false);
                    return;
                }
                const resultBase = (C1 * V1) / C2;
                const resultDisplay = setCalculatedWithUnit('dil-v2', resultBase, 'dil-v2-unit');
                const unitLabel = getUnitLabel('dil-v2-unit');
                steps = [
                    `F√≥rmula: V‚ÇÇ = (C‚ÇÅ √ó V‚ÇÅ) / C‚ÇÇ`,
                    `V‚ÇÇ = (${formatNumber(C1)} √ó ${formatNumber(V1)} L) / ${formatNumber(C2)}`,
                    `V‚ÇÇ = ${formatNumber(resultBase)} L = ${formatNumber(resultDisplay)} ${unitLabel}`
                ];
                showResult('dil-result', `‚úì V‚ÇÇ = ${formatNumber(resultDisplay)} ${unitLabel}`);
            }
            showSteps('dil-steps', steps);
        }

        // Tabela de Massas At√¥micas
        const elementosMassas = {
            'H': { nome: 'Hidrog√™nio', massa: 1.008 },
            'He': { nome: 'H√©lio', massa: 4.003 },
            'Li': { nome: 'L√≠tio', massa: 6.941 },
            'Be': { nome: 'Ber√≠lio', massa: 9.012 },
            'B': { nome: 'Boro', massa: 10.81 },
            'C': { nome: 'Carbono', massa: 12.01 },
            'N': { nome: 'Nitrog√™nio', massa: 14.01 },
            'O': { nome: 'Oxig√™nio', massa: 16.00 },
            'F': { nome: 'Fl√∫or', massa: 19.00 },
            'Ne': { nome: 'Ne√¥nio', massa: 20.18 },
            'Na': { nome: 'S√≥dio', massa: 22.99 },
            'Mg': { nome: 'Magn√©sio', massa: 24.31 },
            'Al': { nome: 'Alum√≠nio', massa: 26.98 },
            'Si': { nome: 'Sil√≠cio', massa: 28.09 },
            'P': { nome: 'F√≥sforo', massa: 30.97 },
            'S': { nome: 'Enxofre', massa: 32.07 },
            'Cl': { nome: 'Cloro', massa: 35.45 },
            'Ar': { nome: 'Arg√¥nio', massa: 39.95 },
            'K': { nome: 'Pot√°ssio', massa: 39.10 },
            'Ca': { nome: 'C√°lcio', massa: 40.08 },
            'Sc': { nome: 'Esc√¢ndio', massa: 44.96 },
            'Ti': { nome: 'Tit√¢nio', massa: 47.87 },
            'V': { nome: 'Van√°dio', massa: 50.94 },
            'Cr': { nome: 'Cromo', massa: 52.00 },
            'Mn': { nome: 'Mangan√™s', massa: 54.94 },
            'Fe': { nome: 'Ferro', massa: 55.85 },
            'Co': { nome: 'Cobalto', massa: 58.93 },
            'Ni': { nome: 'N√≠quel', massa: 58.69 },
            'Cu': { nome: 'Cobre', massa: 63.55 },
            'Zn': { nome: 'Zinco', massa: 65.38 },
            'Ga': { nome: 'G√°lio', massa: 69.72 },
            'Ge': { nome: 'Germ√¢nio', massa: 72.63 },
            'As': { nome: 'Ars√™nio', massa: 74.92 },
            'Se': { nome: 'Sel√™nio', massa: 78.97 },
            'Br': { nome: 'Bromo', massa: 79.90 },
            'Kr': { nome: 'Cript√¥nio', massa: 83.80 },
            'Rb': { nome: 'Rub√≠dio', massa: 85.47 },
            'Sr': { nome: 'Estr√¥ncio', massa: 87.62 },
            'Y': { nome: '√çtrio', massa: 88.91 },
            'Zr': { nome: 'Zirc√¥nio', massa: 91.22 },
            'Nb': { nome: 'Ni√≥bio', massa: 92.91 },
            'Mo': { nome: 'Molibd√™nio', massa: 95.95 },
            'Ru': { nome: 'Rut√™nio', massa: 101.1 },
            'Rh': { nome: 'R√≥dio', massa: 102.9 },
            'Pd': { nome: 'Pal√°dio', massa: 106.4 },
            'Ag': { nome: 'Prata', massa: 107.9 },
            'Cd': { nome: 'C√°dmio', massa: 112.4 },
            'In': { nome: '√çndio', massa: 114.8 },
            'Sn': { nome: 'Estanho', massa: 118.7 },
            'Sb': { nome: 'Antim√¥nio', massa: 121.8 },
            'Te': { nome: 'Tel√∫rio', massa: 127.6 },
            'I': { nome: 'Iodo', massa: 126.9 },
            'Xe': { nome: 'Xen√¥nio', massa: 131.3 },
            'Cs': { nome: 'C√©sio', massa: 132.9 },
            'Ba': { nome: 'B√°rio', massa: 137.3 },
            'La': { nome: 'Lant√¢nio', massa: 138.9 },
            'Ce': { nome: 'C√©rio', massa: 140.1 },
            'Pr': { nome: 'Praseod√≠mio', massa: 140.9 },
            'Nd': { nome: 'Neod√≠mio', massa: 144.2 },
            'Pm': { nome: 'Prom√©cio', massa: 145.0 },
            'Sm': { nome: 'Sam√°rio', massa: 150.4 },
            'Eu': { nome: 'Eur√≥pio', massa: 152.0 },
            'Gd': { nome: 'Gadol√≠nio', massa: 157.3 },
            'Tb': { nome: 'T√©rbio', massa: 158.9 },
            'Dy': { nome: 'Dispr√≥sio', massa: 162.5 },
            'Ho': { nome: 'H√≥lmio', massa: 164.9 },
            'Er': { nome: '√ârbio', massa: 167.3 },
            'Tm': { nome: 'T√∫lio', massa: 168.9 },
            'Yb': { nome: 'It√©rbio', massa: 173.0 },
            'Lu': { nome: 'Lut√©cio', massa: 175.0 },
            'Hf': { nome: 'H√°fnio', massa: 178.5 },
            'Ta': { nome: 'T√¢ntalo', massa: 180.9 },
            'W': { nome: 'Tungst√™nio', massa: 183.8 },
            'Re': { nome: 'R√™nio', massa: 186.2 },
            'Os': { nome: '√ìsmio', massa: 190.2 },
            'Ir': { nome: 'Ir√≠dio', massa: 192.2 },
            'Pt': { nome: 'Platina', massa: 195.1 },
            'Au': { nome: 'Ouro', massa: 197.0 },
            'Hg': { nome: 'Merc√∫rio', massa: 200.6 },
            'Tl': { nome: 'T√°lio', massa: 204.4 },
            'Pb': { nome: 'Chumbo', massa: 207.2 },
            'Bi': { nome: 'Bismuto', massa: 209.0 },
            'Po': { nome: 'Pol√¥nio', massa: 209.0 },
            'At': { nome: 'Astato', massa: 210.0 },
            'Rn': { nome: 'Rad√¥nio', massa: 222.0 },
            'Fr': { nome: 'Fr√¢ncio', massa: 223.0 },
            'Ra': { nome: 'R√°dio', massa: 226.0 },
            'Ac': { nome: 'Act√≠nio', massa: 227.0 },
            'Th': { nome: 'T√≥rio', massa: 232.0 },
            'Pa': { nome: 'Protact√≠nio', massa: 231.0 },
            'U': { nome: 'Ur√¢nio', massa: 238.0 }
        };

        // Parser de f√≥rmulas qu√≠micas
        function parseFormula(formula) {
            const elementos = {};
            
            function parseGroup(str, multiplier = 1) {
                let i = 0;
                while (i < str.length) {
                    if (str[i] === '(') {
                        // Encontrar o par√™ntese de fechamento
                        let depth = 1;
                        let j = i + 1;
                        while (j < str.length && depth > 0) {
                            if (str[j] === '(') depth++;
                            if (str[j] === ')') depth--;
                            j++;
                        }
                        // j agora aponta para depois do ')'
                        const groupContent = str.substring(i + 1, j - 1);
                        
                        // Verificar se h√° n√∫mero ap√≥s o par√™ntese
                        let numStr = '';
                        while (j < str.length && /\d/.test(str[j])) {
                            numStr += str[j];
                            j++;
                        }
                        const groupMultiplier = numStr ? parseInt(numStr) : 1;
                        
                        parseGroup(groupContent, multiplier * groupMultiplier);
                        i = j;
                    } else if (/[A-Z]/.test(str[i])) {
                        // Elemento
                        let element = str[i];
                        i++;
                        
                        // Verificar se h√° letra min√∫scula (s√≠mbolo de 2 letras)
                        while (i < str.length && /[a-z]/.test(str[i])) {
                            element += str[i];
                            i++;
                        }
                        
                        // Verificar n√∫mero
                        let numStr = '';
                        while (i < str.length && /\d/.test(str[i])) {
                            numStr += str[i];
                            i++;
                        }
                        const count = numStr ? parseInt(numStr) : 1;
                        
                        if (elementos[element]) {
                            elementos[element] += count * multiplier;
                        } else {
                            elementos[element] = count * multiplier;
                        }
                    } else {
                        i++;
                    }
                }
            }
            
            parseGroup(formula);
            return elementos;
        }

        // Calcular Massa Molar
        function calcMassaMolar() {
            const formula = document.getElementById('mm-formula').value.trim();
            
            if (!formula) {
                showResult('mm-result', '‚ùå Digite uma f√≥rmula qu√≠mica!', false);
                hideSteps('mm-steps');
                return;
            }
            
            try {
                const elementos = parseFormula(formula);
                const elementosKeys = Object.keys(elementos);
                
                if (elementosKeys.length === 0) {
                    showResult('mm-result', '‚ùå F√≥rmula inv√°lida!', false);
                    hideSteps('mm-steps');
                    return;
                }
                
                let massaTotal = 0;
                let steps = [];
                let detalhes = [];
                
                steps.push(`F√≥rmula: ${formula}`);
                steps.push(`Elementos encontrados:`);
                
                for (const elem of elementosKeys) {
                    if (!elementosMassas[elem]) {
                        showResult('mm-result', `‚ùå Elemento "${elem}" n√£o encontrado na tabela!`, false);
                        hideSteps('mm-steps');
                        return;
                    }
                    
                    const info = elementosMassas[elem];
                    const quantidade = elementos[elem];
                    const massaElemento = info.massa * quantidade;
                    massaTotal += massaElemento;
                    
                    detalhes.push({
                        simbolo: elem,
                        nome: info.nome,
                        massa: info.massa,
                        quantidade: quantidade,
                        total: massaElemento
                    });
                    
                    steps.push(`‚Ä¢ ${elem} (${info.nome}): ${info.massa} g/mol √ó ${quantidade} = ${massaElemento.toFixed(3)} g/mol`);
                }
                
                steps.push(`<strong>Massa Molar Total = ${massaTotal.toFixed(3)} g/mol</strong>`);
                
                showResult('mm-result', `‚úì Massa Molar de ${formula} = ${massaTotal.toFixed(3)} g/mol`);
                showSteps('mm-steps', steps);
                
            } catch (e) {
                showResult('mm-result', '‚ùå Erro ao processar a f√≥rmula. Verifique a sintaxe!', false);
                hideSteps('mm-steps');
            }
        }

        function clearMassaMolar() {
            document.getElementById('mm-formula').value = '';
            document.getElementById('mm-result').classList.remove('show');
            document.getElementById('mm-steps').style.display = 'none';
        }

        // Mostrar lista de elementos dispon√≠veis
        function mostrarElementos() {
            const lista = document.getElementById('elementos-lista');
            if (lista) {
                const elementosArray = Object.entries(elementosMassas).map(([simbolo, info]) => 
                    `<span style="display: inline-block; margin: 2px 5px; padding: 2px 6px; background: #e8f5e9; border-radius: 4px;"><strong>${simbolo}</strong>: ${info.massa}</span>`
                );
                lista.innerHTML = elementosArray.join('');
            }
        }

        // Inicializa√ß√£o
        updatePorcentagemLabels();
        mostrarElementos();
    </script>
</body>
</html>
